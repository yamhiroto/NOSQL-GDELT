{"paragraphs":[{"text":"%md\n## Exploration des donnees GDELT via Spark\nDans ce notebook nous allons commencer a explorer les donnees GDELT qu'on a stoque sur S3","dateUpdated":"2020-01-11T14:04:03+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Exploration des donnees GDELT via Spark</h2>\n<p>Dans ce notebook nous allons commencer a explorer les donnees GDELT qu&rsquo;on a stoque sur S3</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1578751443759_862582930","id":"20181212-102323_67420128","dateCreated":"2020-01-11T14:04:03+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3474"},{"text":"%md Les fichiers sont stoquees compresses, on a besoin d'un bout de code pour les decompresser en parallel sur les workers au fur et a mesure qu'on les lit depuis S3:","dateUpdated":"2020-01-11T15:07:34+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Les fichiers sont stoquees compresses, on a besoin d&rsquo;un bout de code pour les decompresser en parallel sur les workers au fur et a mesure qu&rsquo;on les lit depuis S3:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1578751443761_872586402","id":"20181212-102329_808049084","dateCreated":"2020-01-11T14:04:03+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3475"},{"text":"import spark.implicits._\nimport org.apache.spark.sql.functions._","user":"anonymous","dateUpdated":"2020-01-11T16:21:40+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578759690469_-452648933","id":"20200111-162130_782083733","dateCreated":"2020-01-11T16:21:30+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3476"},{"text":"%md\n### EVENT","user":"anonymous","dateUpdated":"2020-01-11T16:27:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>EVENT</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1578760041326_-591236802","id":"20200111-162721_1795268925","dateCreated":"2020-01-11T16:27:21+0000","dateStarted":"2020-01-11T16:27:30+0000","dateFinished":"2020-01-11T16:27:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3477"},{"text":"import org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\n// 20181201000000.export.CSV.zip\nval textRDD = sc.binaryFiles(\"/tmp/20181201[0-9]*.export.CSV.zip\"). // charger quelques fichers via une regex\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\n\nval eventDF = textRDD.toDF()\n.withColumn(\"GLOBALEVENTID\", split($\"value\", \"\\\\s+\").getItem(0))\n.withColumn(\"SQLDATE\", split($\"value\", \"\\\\s+\").getItem(1))\n.withColumn(\"MonthYear\", split($\"value\", \"\\\\s+\").getItem(2))\n.withColumn(\"Year\", split($\"value\", \"\\\\s+\").getItem(3))\n.withColumn(\"FractionDate\", split($\"value\", \"\\\\s+\").getItem(4))\n.withColumn(\"Actor1Code\", split($\"value\", \"\\\\s+\").getItem(5))\n.withColumn(\"Actor1Name\", split($\"value\", \"\\\\s+\").getItem(6))\n.withColumn(\"Actor1CountryCode\", split($\"value\", \"\\\\s+\").getItem(7))\n.withColumn(\"Actor1KnownGroupCode\", split($\"value\", \"\\\\s+\").getItem(8))\n.withColumn(\"Actor1EthnicCode\", split($\"value\", \"\\\\s+\").getItem(9))\n.withColumn(\"Actor1Religion1Code\", split($\"value\", \"\\\\s+\").getItem(10))\n.withColumn(\"Actor1Religion2Code\", split($\"value\", \"\\\\s+\").getItem(11))\n.withColumn(\"Actor1Type1Code\", split($\"value\", \"\\\\s+\").getItem(12))\n.withColumn(\"Actor1Type2Code\", split($\"value\", \"\\\\s+\").getItem(13))\n.withColumn(\"Actor1Type3Code\", split($\"value\", \"\\\\s+\").getItem(14))\n.withColumn(\"Actor2Code\", split($\"value\", \"\\\\s+\").getItem(15))\n.withColumn(\"Actor2Name\", split($\"value\", \"\\\\s+\").getItem(16))\n.withColumn(\"Actor2CountryCode\", split($\"value\", \"\\\\s+\").getItem(17))\n.withColumn(\"Actor2KnownGroupCode\", split($\"value\", \"\\\\s+\").getItem(18))\n.withColumn(\"Actor2EthnicCode\", split($\"value\", \"\\\\s+\").getItem(19))\n.withColumn(\"Actor2Religion1Code\", split($\"value\", \"\\\\s+\").getItem(20))\n.withColumn(\"Actor2Religion2Code\", split($\"value\", \"\\\\s+\").getItem(21))\n.withColumn(\"Actor2Type1Code\", split($\"value\", \"\\\\s+\").getItem(22))\n.withColumn(\"Actor2Type2Code\", split($\"value\", \"\\\\s+\").getItem(23))\n.withColumn(\"Actor2Type3Code\", split($\"value\", \"\\\\s+\").getItem(24))\n.withColumn(\"IsRootEvent\", split($\"value\", \"\\\\s+\").getItem(25))\n.withColumn(\"EventCode\", split($\"value\", \"\\\\s+\").getItem(26))\n.withColumn(\"EventBaseCode\", split($\"value\", \"\\\\s+\").getItem(27))\n.withColumn(\"EventRootCode\", split($\"value\", \"\\\\s+\").getItem(28))\n.withColumn(\"QuadClass\", split($\"value\", \"\\\\s+\").getItem(29))\n.withColumn(\"GoldsteinScale\", split($\"value\", \"\\\\s+\").getItem(30))\n.withColumn(\"NumMentions\", split($\"value\", \"\\\\s+\").getItem(31))\n.withColumn(\"NumSources\", split($\"value\", \"\\\\s+\").getItem(32))\n.withColumn(\"NumArticles\", split($\"value\", \"\\\\s+\").getItem(33))\n.withColumn(\"AvgTone\", split($\"value\", \"\\\\s+\").getItem(34))\n.withColumn(\"Actor1Geo_Type\", split($\"value\", \"\\\\s+\").getItem(35))\n.withColumn(\"Actor1Geo_FullName\", split($\"value\", \"\\\\s+\").getItem(36))\n.withColumn(\"Actor1Geo_CountryCode\", split($\"value\", \"\\\\s+\").getItem(37))\n.withColumn(\"Actor1Geo_ADM1Code\", split($\"value\", \"\\\\s+\").getItem(38))\n.withColumn(\"Actor1Geo_ADM2Code\", split($\"value\", \"\\\\s+\").getItem(39))\n.withColumn(\"Actor1Geo_Lat\", split($\"value\", \"\\\\s+\").getItem(40))\n.withColumn(\"Actor1Geo_Long\", split($\"value\", \"\\\\s+\").getItem(41))\n.withColumn(\"Actor1Geo_FeatureID\", split($\"value\", \"\\\\s+\").getItem(42))\n.withColumn(\"Actor2Geo_Type\", split($\"value\", \"\\\\s+\").getItem(43))\n.withColumn(\"Actor2Geo_FullName\", split($\"value\", \"\\\\s+\").getItem(44))\n.withColumn(\"Actor2Geo_CountryCode\", split($\"value\", \"\\\\s+\").getItem(45))\n.withColumn(\"Actor2Geo_ADM1Code\", split($\"value\", \"\\\\s+\").getItem(46))\n.withColumn(\"Actor2Geo_ADM2Code\", split($\"value\", \"\\\\s+\").getItem(47))\n.withColumn(\"Actor2Geo_Lat\", split($\"value\", \"\\\\s+\").getItem(48))\n.withColumn(\"Actor2Geo_Long\", split($\"value\", \"\\\\s+\").getItem(49))\n.withColumn(\"Actor2Geo_FeatureID\", split($\"value\", \"\\\\s+\").getItem(50))\n.withColumn(\"ActionGeo_Type\", split($\"value\", \"\\\\s+\").getItem(51))\n.withColumn(\"ActionGeo_FullName\", split($\"value\", \"\\\\s+\").getItem(52))\n.withColumn(\"ActionGeo_CountryCode\", split($\"value\", \"\\\\s+\").getItem(53))\n.withColumn(\"ActionGeo_ADM1Code\", split($\"value\", \"\\\\s+\").getItem(54))\n.withColumn(\"ActionGeo_ADM2Code\", split($\"value\", \"\\\\s+\").getItem(55))\n.withColumn(\"ActionGeo_Lat\", split($\"value\", \"\\\\s+\").getItem(56))\n.withColumn(\"ActionGeo_Long\", split($\"value\", \"\\\\s+\").getItem(57))\n.withColumn(\"ActionGeo_FeatureID\", split($\"value\", \"\\\\s+\").getItem(58))\n.withColumn(\"DATEADDED\", split($\"value\", \"\\\\s+\").getItem(59))\n.withColumn(\"SOURCEURL\", split($\"value\", \"\\\\s+\").getItem(60))\n.drop($\"value\")\n","user":"anonymous","dateUpdated":"2020-01-11T16:37:11+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":195.994,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\ntextRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[80] at flatMap at <console>:79\neventDF: org.apache.spark.sql.DataFrame = [GLOBALEVENTID: string, SQLDATE: string ... 59 more fields]\n"}]},"apps":[],"jobName":"paragraph_1578751443762_873740648","id":"20171217-232457_1732696781","dateCreated":"2020-01-11T14:04:03+0000","dateStarted":"2020-01-11T16:37:11+0000","dateFinished":"2020-01-11T16:37:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3478"},{"text":"eventDF.show()","user":"anonymous","dateUpdated":"2020-01-11T16:37:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+--------+---------+----+------------+----------+----------+-----------------+--------------------+----------------+-------------------+-------------------+---------------+---------------+---------------+----------+----------+-----------------+--------------------+-----------------+-------------------+-------------------+---------------+----------------+---------------+-----------+---------+-------------+-------------+---------+--------------+-----------+-----------+--------------+--------------------+--------------+------------------+---------------------+------------------+--------------------+--------------------+--------------+--------------------+--------------+--------------------+---------------------+--------------------+------------------+-------------+--------------+-------------------+--------------+--------------------+---------------------+------------------+------------------+-------------+--------------+-------------------+---------+---------+\n|GLOBALEVENTID| SQLDATE|MonthYear|Year|FractionDate|Actor1Code|Actor1Name|Actor1CountryCode|Actor1KnownGroupCode|Actor1EthnicCode|Actor1Religion1Code|Actor1Religion2Code|Actor1Type1Code|Actor1Type2Code|Actor1Type3Code|Actor2Code|Actor2Name|Actor2CountryCode|Actor2KnownGroupCode| Actor2EthnicCode|Actor2Religion1Code|Actor2Religion2Code|Actor2Type1Code| Actor2Type2Code|Actor2Type3Code|IsRootEvent|EventCode|EventBaseCode|EventRootCode|QuadClass|GoldsteinScale|NumMentions| NumSources|   NumArticles|             AvgTone|Actor1Geo_Type|Actor1Geo_FullName|Actor1Geo_CountryCode|Actor1Geo_ADM1Code|  Actor1Geo_ADM2Code|       Actor1Geo_Lat|Actor1Geo_Long| Actor1Geo_FeatureID|Actor2Geo_Type|  Actor2Geo_FullName|Actor2Geo_CountryCode|  Actor2Geo_ADM1Code|Actor2Geo_ADM2Code|Actor2Geo_Lat|Actor2Geo_Long|Actor2Geo_FeatureID|ActionGeo_Type|  ActionGeo_FullName|ActionGeo_CountryCode|ActionGeo_ADM1Code|ActionGeo_ADM2Code|ActionGeo_Lat|ActionGeo_Long|ActionGeo_FeatureID|DATEADDED|SOURCEURL|\n+-------------+--------+---------+----+------------+----------+----------+-----------------+--------------------+----------------+-------------------+-------------------+---------------+---------------+---------------+----------+----------+-----------------+--------------------+-----------------+-------------------+-------------------+---------------+----------------+---------------+-----------+---------+-------------+-------------+---------+--------------+-----------+-----------+--------------+--------------------+--------------+------------------+---------------------+------------------+--------------------+--------------------+--------------+--------------------+--------------+--------------------+---------------------+--------------------+------------------+-------------+--------------+-------------------+--------------+--------------------+---------------------+------------------+------------------+-------------+--------------+-------------------+---------+---------+\n|    806933491|20171201|   201712|2017|   2017.9068|    ARGGOV| ARGENTINE|              ARG|                 GOV|               0|                036|                036|             03|              1|            4.0|         3|         1|                3|    2.02578268876611|                0|                  4|             Buenos|         Aires,|        Distrito|       Federal,|  Argentina|       AR|         AR07|        22379| -34.5875|      -58.6725|    -979186|          1|         India|                  IN|            IN|                20|                   77|                IN|      20181201203000|https://www.anine...|          null|                null|          null|                null|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933492|20171201|   201712|2017|   2017.9068|    ARGGOV| ARGENTINE|              ARG|                 GOV|               0|                036|                036|             03|              1|            4.0|         3|         1|                3|    2.02578268876611|                4|             Buenos|             Aires,|       Distrito|        Federal,|      Argentina|         AR|     AR07|        22379|     -34.5875| -58.6725|       -979186|          0|          1|         India|                  IN|            IN|                20|                   77|                IN|      20181201203000|https://www.anine...|          null|                null|          null|                null|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933493|20171201|   201712|2017|   2017.9068|       GRC|     GREEK|              GRC|                 TUR|         TURKISH|                TUR|                  1|            042|            042|             04|         1|       1.9|               10|                   1|               10|  -5.24017467248908|                  4|        Athens,|        AttikíR,|         Greece|         GR|     GR35|        16716|      37.9833|  23.7333|       -814876|          4|    Ankara,|       Ankara,|              Turkey|            TU|              TU68|                27516|           39.9272|             32.8644|             -735338|             4|             Ankara,|       Ankara,|              Turkey|                   TU|                TU68|             27516|      39.9272|       32.8644|            -735338|20181201203000|https://ahvalnews...|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933494|20171201|   201712|2017|   2017.9068|       GRC|     GREEK|              GRC|                 TUR|         TURKISH|                TUR|                  1|            150|            150|             15|         4|      -7.2|               10|                   1|               10|  -5.24017467248908|                  4|        Athens,|        AttikíR,|         Greece|         GR|     GR35|        16716|      37.9833|  23.7333|       -814876|          4|    Athens,|      AttikíR,|              Greece|            GR|              GR35|                16716|           37.9833|             23.7333|             -814876|             4|             Athens,|      AttikíR,|              Greece|                   GR|                GR35|             16716|      37.9833|       23.7333|            -814876|20181201203000|https://ahvalnews...|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933495|20171201|   201712|2017|   2017.9068|       KWT|    KUWAIT|              KWT|                 PER|            PERU|                PER|                  0|            010|            010|             01|         1|       0.0|                4|                   1|                4|  -0.99150141643059|                  1|         Kuwait|              KU|             KU|       29.5|    47.75|           KU|            4|    Lima,|         Lima,|       Peru|         PE|          PE15|               91841|        -12.05|            -77.05|              -352647|                 1|              Kuwait|                  KU|            KU|                29.5|         47.75|                  KU|       20181201203000|https://www.insid...|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933496|20171201|   201712|2017|   2017.9068|       TUR|   TURKISH|              TUR|                 GRC|           GREEK|                GRC|                  1|            043|            043|             04|         1|       2.8|               10|                   1|               10|  -5.24017467248908|                  4|        Ankara,|         Ankara,|         Turkey|         TU|     TU68|        27516|      39.9272|  32.8644|       -735338|          4|    Athens,|      AttikíR,|              Greece|            GR|              GR35|                16716|           37.9833|             23.7333|             -814876|             4|             Ankara,|       Ankara,|              Turkey|                   TU|                TU68|             27516|      39.9272|       32.8644|            -735338|20181201203000|https://ahvalnews...|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933497|20181101|   201811|2018|   2018.8247|    JPNBUS|  JAPANESE|              JPN|                 BUS|       MNCJPNBUS|             TOYOTA|                JPN|            MNC|            BUS|              0|       012|       012|               01|                   1|             -0.4|                  6|                  1|              6|1.92307692307693|              1|      Japan|       JA|           JA|           36|      138|            JA|          1|      Japan|            JA|                  JA|            36|               138|                   JA|                 1|               Japan|                  JA|            JA|                  36|           138|                  JA|       20181201203000|http://www.cityam...|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933498|20181101|   201811|2018|   2018.8247|    JPNGOV|  JAPANESE|              JPN|                 GOV|             JPN|              JAPAN|                JPN|              0|            012|            012|        01|         1|             -0.4|                   4|                1|                  4|   1.92307692307693|              1|           Japan|             JA|         JA|       36|          138|           JA|        1|         Japan|         JA|         JA|            36|                 138|            JA|                 1|                Japan|                JA|                  JA|                  36|           138|                  JA|20181201203000|http://www.cityam...|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933499|20181124|   201811|2018|   2018.8877|       ELI|     FIRST|             LADY|                 ELI|             USA|         WASHINGTON|                USA|              1|            017|            017|        01|         1|              0.0|                   1|                1|                  1|  -3.14285714285715|              1|          Russia|             RS|         RS|       60|          100|           RS|        1|        Russia|         RS|         RS|            60|                 100|            RS|                 1|               Russia|                RS|                  RS|                  60|           100|                  RS|20181201203000|http://tradearabi...|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933500|20181124|   201811|2018|   2018.8877|       ELI|     FIRST|             LADY|                 ELI|             USA|         WASHINGTON|                USA|              1|            017|            017|        01|         1|              0.0|                   7|                1|                  7|  -3.14285714285715|              1|          Russia|             RS|         RS|       60|          100|           RS|        1|       Ukraine|         UP|         UP|            49|                  32|            UP|                 1|              Ukraine|                UP|                  UP|                  49|            32|                  UP|20181201203000|http://tradearabi...|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933501|20181124|   201811|2018|   2018.8877|       OPP| PROTESTER|              OPP|                 CAN|        CANADIAN|                CAN|                  1|            141|            141|             14|         3|      -6.5|                8|                   1|                8|  -6.63265306122449|                  1|         United|         Kingdom|             UK|         UK|       54|           -4|           UK|        1|        United|    Kingdom|         UK|            UK|                  54|            -4|                UK|                    1|            United|             Kingdom|                  UK|            UK|                  54|            -4|                  UK|       20181201203000|https://www.north...|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933502|20181124|   201811|2018|   2018.8877|       PHL|PHILIPPINE|              PHL|                   1|             010|                010|                 01|              1|            0.0|              2|         1|         2|-1.81818181818182|                   4|         Bacolod,|           Bacolod,|        Philippines|             RP|            RPA2|          24250|    10.6677|  122.953|     -2409706|            0|        4|      Bacolod,|   Bacolod,|Philippines|            RP|                RPA2|         24250|           10.6677|              122.953|          -2409706|      20181201203000|https://www.sunst...|          null|                null|          null|                null|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933503|20181124|   201811|2018|   2018.8877|       PHL|PHILIPPINE|              PHL|                   1|             010|                010|                 01|              1|            0.0|              2|         1|         2|-1.81818181818182|                   4|         Bacolod,|           Bacolod,|        Philippines|             RP|            RPA2|          24250|    10.6677|  122.953|     -2409706|            0|        5|        Negros|Occidental,|     Negros|   Occidental,|         Philippines|            RP|              RPH3|                24254|           10.4167|                 123|            -2441789|20181201203000|https://www.sunst...|          null|                null|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933504|20181130|   201811|2018|   2018.9041|       EDU| ECONOMIST|              EDU|                 USA|             THE|                 US|                USA|              0|            130|            130|        13|         3|             -4.4|                  10|                1|                 10|  -7.17821782178218|              1|           China|             CH|         CH|       35|          105|           CH|        1|         China|         CH|         CH|            35|                 105|            CH|                 1|                China|                CH|                  CH|                  35|           105|                  CH|20181201203000|https://www.expre...|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933505|20181201|   201812|2018|   2018.9068|       ARG| ARGENTINA|              ARG|                   0|             036|                036|                 03|              1|            4.0|             10|         1|        10| 2.64705882352942|                   0|                4|             Buenos|             Aires,|       Distrito|        Federal,|      Argentina|         AR|     AR07|        22379|     -34.5875| -58.6725|       -979186|          1|      India|            IN|                  IN|            20|                77|                   IN|    20181201203000|https://www.anine...|                null|          null|                null|          null|                null|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933506|20181201|   201812|2018|   2018.9068|       BUS|  PRODUCER|              BUS|                   1|            1821|                182|                 18|              4|           -9.0|              3|         1|         3|-0.71736011477761|                   0|                2|                New|              York,|         United|          States|             US|       USNY|  42.1497|     -74.9384|           NY|        2|           New|      York,|     United|        States|                  US|          USNY|           42.1497|             -74.9384|                NY|      20181201203000|https://dailycall...|          null|                null|          null|                null|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933507|20181201|   201812|2018|   2018.9068|       CAN|    CANADA|              CAN|                   1|             026|                026|                 02|              1|            4.0|             10|         1|        10| 1.43884892086331|                   0|                1|             Canada|                 CA|             CA|              60|            -96|         CA|        1|       Canada|           CA|       CA|            60|        -96|         CA|20181201203000|https://www.620ck...|          null|              null|                 null|              null|                null|                null|          null|                null|          null|                null|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933508|20181201|   201812|2018|   2018.9068|       CHN|     CHINA|              CHN|                   1|             030|                030|                 03|              1|            4.0|             10|         1|        10|-1.89573459715639|                   0|                4|              Kerch|            Strait,|         Russia|      (general),|         Russia|         RS|     RS00|        25065|      45.3389|  36.6169|      -1041278|          4|      Kerch|       Strait,|              Russia|    (general),|            Russia|                   RS|              RS00|               25065|             45.3389|       36.6169|            -1041278|20181201203000|http://www.latime...|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933509|20181201|   201812|2018|   2018.9068|    CHRCTH|     ROMAN|         CATHOLIC|                 CHR|             CTH|                  0|                010|            010|             01|              1|       0.0|         3|                1|                   3|-1.10787172011662|                  0|                  4|         Mexico|           City,|       Distrito|   Federal,|   Mexico|           MX|         MX09|    20887|       19.4342|   -99.1386|   -1658079|             4|                 Los|        Pinos,|         Tlaxcala,|               Mexico|                MX|                MX29|               20772|       19.1944|            -98.3292|       6253946|      20181201203000| https://www.expre...|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n|    806933510|20181201|   201812|2018|   2018.9068|    CHRCTH|     ROMAN|         CATHOLIC|                 CHR|             CTH|                  0|                010|            010|             01|              1|       0.0|         2|                1|                   2|-1.10787172011662|                  0|                  4|            Los|          Pinos,|      Tlaxcala,|     Mexico|       MX|         MX29|        20772|  19.1944|      -98.3292|    6253946|          4|           Los|              Pinos,|     Tlaxcala,|            Mexico|                   MX|              MX29|               20772|             19.1944|      -98.3292|             6253946|20181201203000|https://www.expre...|                 null|                null|              null|         null|          null|               null|          null|                null|                 null|              null|              null|         null|          null|               null|     null|     null|\n+-------------+--------+---------+----+------------+----------+----------+-----------------+--------------------+----------------+-------------------+-------------------+---------------+---------------+---------------+----------+----------+-----------------+--------------------+-----------------+-------------------+-------------------+---------------+----------------+---------------+-----------+---------+-------------+-------------+---------+--------------+-----------+-----------+--------------+--------------------+--------------+------------------+---------------------+------------------+--------------------+--------------------+--------------+--------------------+--------------+--------------------+---------------------+--------------------+------------------+-------------+--------------+-------------------+--------------+--------------------+---------------------+------------------+------------------+-------------+--------------+-------------------+---------+---------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1578760618637_-16366106","id":"20200111-163658_594263196","dateCreated":"2020-01-11T16:36:58+0000","dateStarted":"2020-01-11T16:37:17+0000","dateFinished":"2020-01-11T16:37:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3479"},{"text":"%md\n### GLOBAL KNOWLEDGE GRAPH","user":"anonymous","dateUpdated":"2020-01-11T16:27:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>GLOBAL KNOWLEDGE GRAPH</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1578759749237_-1674919568","id":"20200111-162229_916549909","dateCreated":"2020-01-11T16:22:29+0000","dateStarted":"2020-01-11T16:27:02+0000","dateFinished":"2020-01-11T16:27:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3480"},{"text":"val gkgRDD = sc.binaryFiles(\"/tmp/20181201234500.gkg.csv.zip\"). // charger quelques fichers via une regex   // essai sur un seul fichier ! remplacer par \"/tmp/20181201[0-9]*.gkg.csv.zip\" pour avoir acces a tous les fichiers\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\n\nval gkgDF = gkgRDD.toDF()\n.withColumn(\"Row\", split($\"value\", \"\\\\s+\").getItem(0))\n.withColumn(\"GKGRECORDID\", split($\"value\", \"\\\\s+\").getItem(1))\n.withColumn(\"DATE\", split($\"value\", \"\\\\s+\").getItem(2))\n.withColumn(\"SourceCollectionIdentifier\", split($\"value\", \"\\\\s+\").getItem(3))\n.withColumn(\"SourceCommonName\", split($\"value\", \"\\\\s+\").getItem(4))\n.withColumn(\"DocumentIdentifier\", split($\"value\", \"\\\\s+\").getItem(5))\n.withColumn(\"Counts\", split($\"value\", \"\\\\s+\").getItem(6))\n.withColumn(\"V2Counts\", split($\"value\", \"\\\\s+\").getItem(7))\n.withColumn(\"Themes\", split($\"value\", \"\\\\s+\").getItem(8))\n.withColumn(\"V2Themes\", split($\"value\", \"\\\\s+\").getItem(9))\n.withColumn(\"Locations\", split($\"value\", \"\\\\s+\").getItem(10))\n.withColumn(\"V2Locations\", split($\"value\", \"\\\\s+\").getItem(11))\n.withColumn(\"Persons\", split($\"value\", \"\\\\s+\").getItem(12))\n.withColumn(\"V2Persons\", split($\"value\", \"\\\\s+\").getItem(13))\n.withColumn(\"Organizations\", split($\"value\", \"\\\\s+\").getItem(14))\n.withColumn(\"V2Organizations\", split($\"value\", \"\\\\s+\").getItem(15))\n.withColumn(\"V2Tone\", split($\"value\", \"\\\\s+\").getItem(16))\n.withColumn(\"Dates\", split($\"value\", \"\\\\s+\").getItem(17))\n.withColumn(\"GCAM\", split($\"value\", \"\\\\s+\").getItem(18))\n.withColumn(\"SharingImage\", split($\"value\", \"\\\\s+\").getItem(19))\n.withColumn(\"RelatedImages\", split($\"value\", \"\\\\s+\").getItem(20))\n.withColumn(\"SocialImageEmbeds\", split($\"value\", \"\\\\s+\").getItem(21))\n.withColumn(\"SocialVideoEmbeds\", split($\"value\", \"\\\\s+\").getItem(22))\n.withColumn(\"Quotations\", split($\"value\", \"\\\\s+\").getItem(23))\n.withColumn(\"AllNames\", split($\"value\", \"\\\\s+\").getItem(24))\n.withColumn(\"Amounts\", split($\"value\", \"\\\\s+\").getItem(25))\n.withColumn(\"TranslationInfo\", split($\"value\", \"\\\\s+\").getItem(26))\n.withColumn(\"Extras\", split($\"value\", \"\\\\s+\").getItem(27))\n.drop($\"value\")","user":"anonymous","dateUpdated":"2020-01-11T16:36:28+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"gkgRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[75] at flatMap at <console>:74\ngkgDF: org.apache.spark.sql.DataFrame = [Row: string, GKGRECORDID: string ... 26 more fields]\n"}]},"apps":[],"jobName":"paragraph_1578758438196_-144445330","id":"20200111-160038_1308018681","dateCreated":"2020-01-11T16:00:38+0000","dateStarted":"2020-01-11T16:36:28+0000","dateFinished":"2020-01-11T16:36:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3481"},{"text":"gkgDF.show","user":"anonymous","dateUpdated":"2020-01-11T16:36:32+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+--------------+----+--------------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n|              Row|   GKGRECORDID|DATE|SourceCollectionIdentifier|    SourceCommonName|  DocumentIdentifier|              Counts|            V2Counts|              Themes|            V2Themes|           Locations|         V2Locations|             Persons|           V2Persons|       Organizations|     V2Organizations|              V2Tone|               Dates|                GCAM|        SharingImage|       RelatedImages|   SocialImageEmbeds|   SocialVideoEmbeds|          Quotations|            AllNames|             Amounts|     TranslationInfo|              Extras|\n+-----------------+--------------+----+--------------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\n| 20181201234500-0|20181201234500|   1|                   news.am|https://news.am/e...|TAX_ETHNICITY;TAX...|GENERAL_GOVERNMEN...|1#Armenia#AM#AM#4...|            Syunik',|Armenia#AM#AM08#3...|1#Armenian#AM#AM#...|            Syunik',|Armenia#AM#AM08#4...|            Syunik',|Armenia#AM#AM08#4...|            Syunik',|Armenia#AM#AM08#4...|            Syunik',|Armenia#AM#AM08#4...|               nikol|           pashinyan|               Nikol| Pashinyan,149;Nikol|       Pashinyan,538|0,0.9259259259259...|wc:95,c12.1:3,c12...|https://news.am/i...|https://youtube.c...|\n| 20181201234500-1|20181201234500|   1|      californiagoldenb...|https://www.calif...|       2#California,|              United|States#US#USCA#36...|       2#California,|              United|States#US#USCA##3...|              United|States#US#USCA##3...|              United|States#US#USCA##3...|            stanford|    cardinal;paulson|       adebo;cameron|      scarlett;david|                shaw|            Stanford| Cardinal,90;Paulson|   Adebo,324;Cameron|  Scarlett,467;David|            Shaw,670|0,4.8387096774193...|wc:118,c1.2:1,c12...|https://cdn.vox-c...|\n| 20181201234500-2|20181201234500|   1|                    qz.com|https://qz.com/qu...|WB_1331_HEALTH_TE...|MEDIA_SOCIAL,795;...|               2#New|               York,|              United|States#US#USNY#42...|             (Pl67),|Poland#PL#PL67#52...|               2#New|               York,|              United|States#US#USNY##4...|             (Pl67),|Poland#PL#PL67#24...|google;facebook;moma|              design|Google,3009;Faceb...|         Design,3686|2.27817745803357,...|wc:740,c1.1:1,c12...|https://cms.qz.co...|https://cms.qz.co...|         3618|74||It|\n| 20181201234500-3|20181201234500|   1|              buzzfeed.com|https://www.buzzf...|              disney|Disney,111;Disney...|4.34782608695652,...|wc:64,c12.1:8,c12...|https://img.buzzf...|https://instagram...|https://youtube.c...|       242|240||Lots|                  of|              adults|                seem|                  to|               think|                that|                once|                  we|               reach|      teenage-status|                   ,|                  we|                lose|            interest|                  in|\n| 20181201234500-4|20181201234500|   1|           animalforum.com|http://www.animal...|             welcome|                  to|              animal|               forum|             Welcome|                  To|              Animal|            Forum,23|5.26315789473684,...|wc:49,c12.1:4,c12...|https://fbcdn-pro...|<PAGE_LINKS>http:...|                null|                null|                null|                null|                null|                null|                null|                null|                null|                null|                null|\n| 20181201234500-5|20181201234500|   1|                iheart.com|https://kogo.ihea...|         4#Alhambra,|         Castilla-La|            Manacha,|Spain#SP#SP54#38....|States#US#US#39.8...|              United|States#US#USMS#32...|                Vila|               Real,|Portugal#PO#PO21#...|         4#Alhambra,|         Castilla-La|            Manacha,|Spain#SP#SP54#258...|                Vila|               Real,|Portugal#PO#PO21#...|              United|States#US#USMS##3...|         nightflyers|                syfy|         Nightflyers|            Syfy,674|\n| 20181201234500-6|20181201234500|   1|      voiceofalexandria...|https://www.voice...|TAX_FNCACT;TAX_FN...|TERROR,1370;REBEL...|           4#Moscow,|             Moskva,|Russia#RS#RS48#55...|         Washington,|              United|States#US#USDC#38...|              House,|            District|                  Of|           Columbia,|              United|States#US#USDC#38...|              United|States#US#USCA#36...|1#Russia#RS#RS##6...|              United|States#US#USCA##3...|              House,|            District|                  Of|           Columbia,|\n| 20181201234500-7|20181201234500|   1|              turnto23.com|https://www.turnt...|KILL#5#Fleet#1#Ba...|KILL#5#Fleet#1#Ba...|TAX_MILITARY_TITL...|TAX_FNCACT_DEPUTY...|           4#Arabian|                Sea,|               India|          (General),|India#IN#IN00#20#...|                Sea,|            Djibouti|          (General),|Djibouti#DJ#DJ00#...|         Washington,|              United|States#US#USDC#38...|1#Bahrain#BA#BA##...|                Sea,|               India|          (General),|India#IN#IN00##20...|                Sea,|            Djibouti|\n| 20181201234500-8|20181201234500|   1|               570news.com|https://www.570ne...|WB_2670_JOBS;WB_6...|WB_2670_JOBS,124;...|                nate|      grimes;braxton|        huggins;mark|        crowe;deshon|              taylor|                Nate|  Grimes,285;Braxton|    Huggins,255;Mark|    Crowe,546;Deshon|           Taylor,37|          associated|               press|          Associated|           Press,933|-3.76344086021505...|wc:162,c12.1:2,c1...|              Deshon|       Taylor,38;Cal|       Poly,200;Nate|   Grimes,319;Fresno|       State,340;Cal|\n| 20181201234500-9|20181201234500|   1|                iheart.com|https://kissfm107...|MANMADE_DISASTER_...|TAX_FNCACT_WOMAN,...|            1#United|States#US#US#39.8...|1#America#US#US##...|States#US#US##39....|              lucien|       grainge;monte|       lipman;taylor|               swift|              Lucien|  Grainge,1263;Monte|   Lipman,1278;Monte|  Lipman,1354;Taylor|            Swift,12|               music|     group;universal|               music|      group;republic|      records;united|              states|               Music|     Group,768;Music|\n|20181201234500-10|20181201234500|   1|                wvnews.com|https://www.wvnew...|TAKE_OFFICE;TAX_F...|BAN,3511;PRIVATIZ...|1#Mexico#MX#MX#23...|           Guerrero,|Mexico#MX#MX12#16...|States#US#US#39.8...|Kingdom#UK#UK#54#...|           Cardenas,|             Oaxaca,|Mexico#MX#MX20#17...|               City,|            Distrito|            Federal,|Mexico#MX#MX09#19...|            Coahuila|                  De|           Zaragoza,|Mexico#MX#MX07#26...|             London,|                City|                 Of,|              United|Kingdom#UK#UKH9#5...|\n|20181201234500-11|20181201234500|   1|      thenationonlineng...|http://thenationo...|TAX_FNCACT;TAX_FN...|PROTEST,136;TAX_F...|1#Nigeria#NI#NI#1...|1#Nigeria#NI#NI##...|              energy|        solutions;lg|         electronics|                west|           africa;lg|         electronics|              Energy|    Solutions,371;Lg|         Electronics|                West|       Africa,400;Lg|  Electronics,106;Lg|  Electronics,388;Lg|  Electronics,593;Lg|    Electronics,2552|2.98507462686567,...|wc:453,c1.2:2,c12...|http://thenationo...|https://youtube.c...|\n|20181201234500-12|20181201234500|   1|           98theticket.com|http://www.98thet...|          2#Florida,|              United|States#US#USFL#27...|States#US#US#39.8...|            Florida,|              United|States#US#USFL#27...|            3#Tampa,|            Florida,|              United|States#US#USFL#FL...|              United|States#US#USFL##2...|              United|States#US#USFL##2...|             darriel|         mack;teresa|     milton;mckenzie|              milton|             Darriel|    Mack,1091;Teresa| Milton,305;Mckenzie|           Milton,43|\n|20181201234500-13|20181201234500|   1|                  wbir.com|https://www.wbir....|WB_1979_NATURAL_R...|TAX_WORLDLANGUAGE...|          gatlinburg|                fire|    department;great|               smoky|           mountains|            national|     park;gatlinburg|              police|          department|          Gatlinburg|                Fire|Department,651;Great|               Smoky|           Mountains|            National|  Park,62;Gatlinburg|              Police|      Department,682|-0.84745762711864...|      1#0#0#2014#232|wc:100,c12.1:2,c1...|\n|20181201234500-14|20181201234500|   1|      southeastasiapost...|https://www.south...|TAX_FNCACT;TAX_FN...|TAX_RELIGION_SIKH...|        4#Gurudwara,|            Haryana,|India#IN#IN10#29....|             Punjab,|India#IN#IN23#31....|             Punjab,|Pakistan#PK#PK04#...|1#India#IN#IN##20...|             Punjab,|India#IN#IN23#178...|             Punjab,|India#IN#IN23#178...|             Punjab,|India#IN#IN23#178...|             Punjab,|India#IN#IN23#178...|             Punjab,|India#IN#IN23#178...|            Haryana,|India#IN#IN10#701...|            Haryana,|\n|20181201234500-15|20181201234500|   1|                  wirx.com|https://www.wirx....|LEADER;TAX_FNCACT...|UNGP_FORESTS_RIVE...|             3#Great|              Lakes,|           Michigan,|              United|States#US#USMI#45...|               Lock,|           Michigan,|              United|States#US#USMI#46...|              United|States#US#USMI#43...|           Superior,|           Michigan,|              United|States#US#USMI#47...|              Locks,|           Michigan,|              United|States#US#USMI#46...|               3#Poe|               Lock,|\n|20181201234500-16|20181201234500|   1|      goldcoastbulletin...|https://www.goldc...|TAX_FNCACT;TAX_FN...|WB_696_PUBLIC_SEC...|1#Australia#AS#AS...|Kingdom#UK#UK#54#...|            1#United|Kingdom#UK#UK##54...|-0.42283298097251...|wc:834,c1.3:1,c12...|https://cdn.newsa...|https://cdn.newsa...|        1436|35||Are|                 you|              really|             wearing|               those|  pants?#1487|45||Do|                 you|               think|                that|              really|          flattering|                 for|you?#2999|33||tra...|\n|20181201234500-17|20181201234500|   1|               570news.com|https://www.570ne...|             4#Grand|              Forks,|             British|           Columbia,|Canada#CA#CA02#49...|             Dakota,|              United|States#US#USND#47...|              United|States#US#USID#44...|            2#Idaho,|              United|States#US#USID##4...|             Dakota,|              United|States#US#USND##4...|             Dakota,|              United|States#US#USND##4...|             Dakota,|              United|States#US#USND##4...|             Dakota,|\n|20181201234500-18|20181201234500|   1|                  wlos.com|https://wlos.com/...|     TAX_ECON_PRICE;| TAX_ECON_PRICE,283;|2.77777777777778,...|       4#12#23#0#127|wc:62,c12.1:3,c12...|http://static-18....|                Lake|              Julian|    Festival,66;Lake| Julian,120;Buncombe|              County|         Special,394|          20,dollars|                 for|               large|           vans,178;|<PAGE_LINKS>https...|STAFF</PAGE_AUTHORS>|                null|                null|                null|                null|                null|\n|20181201234500-19|20181201234500|   1|      lajuntatribunedem...|http://www.lajunt...|WB_698_TRADE;TAX_...|TAX_WORLDLANGUAGE...|1#Australia#AS#AS...|States#US#US#39.8...|              France|          (General),|France#FR#FR00#48...|         Washington,|              United|States#US#USDC#38...|              House,|            District|                  Of|           Columbia,|              United|States#US#USDC#38...|Africa#SF#SF#-30#...|             Strait,|              Russia|          (General),|Russia#RS#RS00#45...|              Osaka,|Japan#JA#JA32#34....|\n+-----------------+--------------+----+--------------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1578758621203_220741028","id":"20200111-160341_388192140","dateCreated":"2020-01-11T16:03:41+0000","dateStarted":"2020-01-11T16:36:32+0000","dateFinished":"2020-01-11T16:36:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3482"},{"text":"%md\n### MENTION ","user":"anonymous","dateUpdated":"2020-01-11T16:27:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>MENTION</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1578759449903_-1141286523","id":"20200111-161729_1436776043","dateCreated":"2020-01-11T16:17:29+0000","dateStarted":"2020-01-11T16:27:07+0000","dateFinished":"2020-01-11T16:27:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3483"},{"text":"val mentionRDD = sc.binaryFiles(\"/tmp/20181201234500.mentions.CSV.zip\"). // charger quelques fichers via une regex   // essai sur un seul fichier ! remplacer par \"/tmp/20181201[0-9]*.mentions.CSV.zip\" pour avoir acces a tous les fichiers\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\nval mentionDF = mentionRDD.toDF()\n.withColumn(\"Row\", split($\"value\", \"\\\\s+\").getItem(0))\n.withColumn(\"GLOBALEVENTID\", split($\"value\", \"\\\\s+\").getItem(1))\n.withColumn(\"EventTimeDate\", split($\"value\", \"\\\\s+\").getItem(2))\n.withColumn(\"MentionTimeDate\", split($\"value\", \"\\\\s+\").getItem(3))\n.withColumn(\"MentionType\", split($\"value\", \"\\\\s+\").getItem(4))\n.withColumn(\"MentionSourceName\", split($\"value\", \"\\\\s+\").getItem(5))\n.withColumn(\"MentionIdentifier\", split($\"value\", \"\\\\s+\").getItem(6))\n.withColumn(\"SentenceID\", split($\"value\", \"\\\\s+\").getItem(7))\n.withColumn(\"Actor1CharOffset\", split($\"value\", \"\\\\s+\").getItem(8))\n.withColumn(\"Actor2CharOffset\", split($\"value\", \"\\\\s+\").getItem(9))\n.withColumn(\"ActionCharOffset\", split($\"value\", \"\\\\s+\").getItem(10))\n.withColumn(\"InRawText\", split($\"value\", \"\\\\s+\").getItem(11))\n.withColumn(\"Confidence\", split($\"value\", \"\\\\s+\").getItem(12))\n.withColumn(\"MentionDocLen\", split($\"value\", \"\\\\s+\").getItem(13))\n.withColumn(\"MentionDocTone\", split($\"value\", \"\\\\s+\").getItem(14))\n.withColumn(\"MentionDocTranslationInfo\", split($\"value\", \"\\\\s+\").getItem(15))\n.withColumn(\"Extras\", split($\"value\", \"\\\\s+\").getItem(16))\n.drop($\"value\")","user":"anonymous","dateUpdated":"2020-01-11T16:34:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":true},"editorMode":"ace/mode/scala","editorHide":false,"tableHide":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mentionRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[70] at flatMap at <console>:74\ndffrom_mentionRDD: org.apache.spark.sql.DataFrame = [Row: string, GLOBALEVENTID: string ... 15 more fields]\n"}]},"apps":[],"jobName":"paragraph_1578760083605_700242662","id":"20200111-162803_300481733","dateCreated":"2020-01-11T16:28:03+0000","dateStarted":"2020-01-11T16:31:08+0000","dateFinished":"2020-01-11T16:31:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3484"},{"text":"mentionDF.show()","user":"anonymous","dateUpdated":"2020-01-11T16:35:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+--------------+--------------+---------------+--------------------+--------------------+-----------------+----------+----------------+----------------+----------------+---------+----------+-----------------+--------------+-------------------------+------+\n|      Row| GLOBALEVENTID| EventTimeDate|MentionTimeDate|         MentionType|   MentionSourceName|MentionIdentifier|SentenceID|Actor1CharOffset|Actor2CharOffset|ActionCharOffset|InRawText|Confidence|    MentionDocLen|MentionDocTone|MentionDocTranslationInfo|Extras|\n+---------+--------------+--------------+---------------+--------------------+--------------------+-----------------+----------+----------------+----------------+----------------+---------+----------+-----------------+--------------+-------------------------+------+\n|806954130|20181201234500|20181201234500|              1|townsvillebulleti...|https://www.towns...|               18|      4615|              -1|            4770|               1|       50|      5395|-6.67420814479638|              |                     null|  null|\n|806954131|20181201234500|20181201234500|              1|townsvillebulleti...|https://www.towns...|               18|      4615|            4638|            4664|               1|       50|      5395|-6.67420814479638|              |                     null|  null|\n|806951219|20181201231500|20181201234500|              1|   dailyprogress.com|https://www.daily...|                4|       541|              -1|             551|               1|       60|      2038|-1.75953079178886|              |                     null|  null|\n|806951219|20181201231500|20181201234500|              1|   hickoryrecord.com|https://www.hicko...|                4|       541|              -1|             551|               1|       60|      2118|-1.69014084507043|              |                     null|  null|\n|806951219|20181201231500|20181201234500|              1|   nbclosangeles.com|https://www.nbclo...|                4|       524|              -1|             534|               1|       60|      2342|-2.63157894736842|              |                     null|  null|\n|711572681|20171201133000|20181201234500|              1|   dailyprogress.com|https://www.daily...|                9|      1833|            1810|            1800|               1|      100|      2038|-1.75953079178886|              |                     null|  null|\n|711572681|20171201133000|20181201234500|              1|   hickoryrecord.com|https://www.hicko...|                9|      1833|            1810|            1800|               1|      100|      2118|-1.69014084507043|              |                     null|  null|\n|711572681|20171201133000|20181201234500|              1|   nbclosangeles.com|https://www.nbclo...|               12|      2089|            2066|            2056|               1|      100|      2342|-2.63157894736842|              |                     null|  null|\n|806938383|20181201211500|20181201234500|              1|          12news.com|https://www.12new...|                5|       492|             460|             448|               0|       20|       849|-2.02702702702703|              |                     null|  null|\n|806938384|20181201211500|20181201234500|              1|          12news.com|https://www.12new...|                5|       492|             460|             448|               0|       20|       849|-2.02702702702703|              |                     null|  null|\n|806938385|20181201211500|20181201234500|              1|          12news.com|https://www.12new...|                5|       492|             460|             448|               1|       60|       849|-2.02702702702703|              |                     null|  null|\n|806938385|20181201211500|20181201234500|              1|   dailyprogress.com|https://www.daily...|                4|       541|             501|             491|               1|       60|      2038|-1.75953079178886|              |                     null|  null|\n|806938385|20181201211500|20181201234500|              1|   hickoryrecord.com|https://www.hicko...|                4|       541|             501|             491|               1|       60|      2118|-1.69014084507043|              |                     null|  null|\n|806938385|20181201211500|20181201234500|              1|   nbclosangeles.com|https://www.nbclo...|                4|       524|             484|             474|               1|       60|      2342|-2.63157894736842|              |                     null|  null|\n|806954132|20181201234500|20181201234500|              1|        mirror.co.uk|https://www.mirro...|                8|      2035|              -1|            1994|               1|      100|      2692|-2.02839756592292|              |                     null|  null|\n|806954133|20181201234500|20181201234500|              1|townsvillebulleti...|https://www.towns...|               18|      4638|              -1|            4664|               1|       50|      5395|-6.67420814479638|              |                     null|  null|\n|711573016|20171201133000|20181201234500|              1|   dailyprogress.com|https://www.daily...|                9|      1810|            1833|            1800|               1|      100|      2038|-1.75953079178886|              |                     null|  null|\n|711573016|20171201133000|20181201234500|              1|   hickoryrecord.com|https://www.hicko...|                9|      1810|            1833|            1800|               1|      100|      2118|-1.69014084507043|              |                     null|  null|\n|711573016|20171201133000|20181201234500|              1|   nbclosangeles.com|https://www.nbclo...|               12|      2066|            2089|            2056|               1|      100|      2342|-2.63157894736842|              |                     null|  null|\n|806954134|20181201234500|20181201234500|              1|thenationonlineng...|http://thenationo...|                7|      1725|            1825|            1802|               0|       20|      6229| 4.71153846153846|              |                     null|  null|\n+---------+--------------+--------------+---------------+--------------------+--------------------+-----------------+----------+----------------+----------------+----------------+---------+----------+-----------------+--------------+-------------------------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1578760286297_-1117423869","id":"20200111-163126_611491370","dateCreated":"2020-01-11T16:31:26+0000","dateStarted":"2020-01-11T16:31:41+0000","dateFinished":"2020-01-11T16:31:42+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:3485"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578760425111_2052319816","id":"20200111-163345_678226547","dateCreated":"2020-01-11T16:33:45+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3486"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1578760425305_2074635252","id":"20200111-163345_867293733","dateCreated":"2020-01-11T16:33:45+0000","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3487"},{"text":"%md A vous de jouer ! Utilisez la documentation GDELT(https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/) et commencez a explorer les donnees via les API Spark.","dateUpdated":"2020-01-11T14:04:03+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>A vous de jouer ! Utilisez la documentation GDELT(<a href=\"https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/\">https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/</a>) et commencez a explorer les donnees via les API Spark.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1578751443763_873355899","id":"20171218-084519_765381887","dateCreated":"2020-01-11T14:04:03+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:3488"}],"name":"gdeltExploration (Local)","id":"2EXJJSE4U","angularObjects":{"2EXJUKKP2:shared_process":[],"2EZYURP9P:shared_process":[],"2EXD1X6QR:shared_process":[],"2EWB9MPVB:shared_process":[],"2EYKD3319:shared_process":[],"2EYNPNK8F:shared_process":[],"2EYSSD1Q2:shared_process":[],"2EXDX9ATP:shared_process":[],"2EXJSF8XP:shared_process":[],"2EY16R2HX:shared_process":[],"2EZ3KDKHS:shared_process":[],"2EZFP87R1:shared_process":[],"2EYSMFRX4:shared_process":[],"2EXY66R8Y:shared_process":[],"2EZ991KTU:shared_process":[],"2EX58WG7K:shared_process":[],"2EZDJ297R:shared_process":[],"2EYWATTPE:shared_process":[],"2F13FCQ7Y:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}