{"paragraphs":[{"text":"%md\n## Exploration des donnees GDELT via Spark\nDans ce notebook nous allons commencer a explorer les donnees GDELT qu'on a stoque sur S3","dateUpdated":"2020-01-17T07:54:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h2>Exploration des donnees GDELT via Spark</h2>\n<p>Dans ce notebook nous allons commencer a explorer les donnees GDELT qu&rsquo;on a stoque sur S3</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247674006_1305427784","id":"20181212-102323_67420128","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1722"},{"text":"%md\n","dateUpdated":"2020-01-17T07:54:34+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579247674007_1305043035","id":"20200115-201642_1185871106","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1723"},{"text":"%md Les fichiers sont stoquees compresses, on a besoin d'un bout de code pour les decompresser en parallel sur les workers au fur et a mesure qu'on les lit depuis S3:","dateUpdated":"2020-01-17T07:54:34+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>Les fichiers sont stoquees compresses, on a besoin d&rsquo;un bout de code pour les decompresser en parallel sur les workers au fur et a mesure qu&rsquo;on les lit depuis S3:</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247674008_1303119290","id":"20181212-102329_808049084","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1724"},{"text":"%md\n","dateUpdated":"2020-01-17T07:54:34+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579247674009_1302734542","id":"20200114-144519_754603050","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1725"},{"text":"import spark.implicits._\nimport org.apache.spark.sql.functions._","dateUpdated":"2020-01-17T08:16:38+0000","config":{"tableHide":false,"editorSetting":{"language":"scala","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nimport org.apache.spark.sql.functions._\n"}]},"apps":[],"jobName":"paragraph_1579247674010_1303888788","id":"20200111-162130_782083733","dateCreated":"2020-01-17T07:54:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1726","user":"anonymous","dateFinished":"2020-01-17T08:16:40+0000","dateStarted":"2020-01-17T08:16:38+0000"},{"text":"%md\n### EVENT","dateUpdated":"2020-01-17T07:54:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>EVENT</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247674011_1303504039","id":"20200111-162721_1795268925","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1727"},{"text":"import org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\n// 20181201000000.export.CSV.zip\nval textRDD = sc.binaryFiles(\"/tmp/20181201[0-9]*.export.CSV.zip\"). // charger quelques fichers via une regex\n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\n","dateUpdated":"2020-01-17T08:16:57+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\ntextRDD: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[35] at flatMap at <console>:47\n"}]},"apps":[],"jobName":"paragraph_1579247674013_1301195546","id":"20200113-140431_2051607335","dateCreated":"2020-01-17T07:54:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1728","user":"anonymous","dateFinished":"2020-01-17T08:16:59+0000","dateStarted":"2020-01-17T08:16:57+0000"},{"text":"import org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\n\n// 20181201000000.export.CSV.zip\n\n//exporter fichiers issus de masterfilelist.txt\nval textRDD_eng = sc.binaryFiles(\"/zeppelin/tmp/20181201[0-9]*.export.CSV.zip\"). // charger quelques fichers via une regex   \n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\n    \n//exporter fichiers issus de masterfilelist-translation.txt\nval textRDD_translate = sc.binaryFiles(\"/zeppelin/tmp/20181201[0-9]*.translation.export.CSV.zip\"). \n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\n    \n\n//concaténer les RDD et transformer en DataFrame                           //Pour des raisons de cohérence, nous indiquons ici le nom des colonnes comme indiqué dans la documentation GDELT. Nous les renommerons lorsque nécessaire plus bas\nval eventDF = textRDD_eng.union(textRDD_translate).toDF()\n.withColumn(\"GLOBALEVENTID\", split($\"value\", \"\\\\t\").getItem(0))\n.withColumn(\"Day\", split($\"value\", \"\\\\t\").getItem(1))\n.withColumn(\"MonthYear\", split($\"value\", \"\\\\t\").getItem(2))\n.withColumn(\"Year\", split($\"value\", \"\\\\t\").getItem(3))\n.withColumn(\"FractionDate\", split($\"value\", \"\\\\t\").getItem(4))\n.withColumn(\"Actor1Code\", split($\"value\", \"\\\\t\").getItem(5))\n.withColumn(\"Actor1Name\", split($\"value\", \"\\\\t\").getItem(6))\n.withColumn(\"Actor1CountryCode\", split($\"value\", \"\\\\t\").getItem(7))\n.withColumn(\"Actor1KnownGroupCode\", split($\"value\", \"\\\\t\").getItem(8))\n.withColumn(\"Actor1EthnicCode\", split($\"value\", \"\\\\t\").getItem(9))\n.withColumn(\"Actor1Religion1Code\", split($\"value\", \"\\\\t\").getItem(10))\n.withColumn(\"Actor1Religion2Code\", split($\"value\", \"\\\\t\").getItem(11))\n.withColumn(\"Actor1Type1Code\", split($\"value\", \"\\\\t\").getItem(12))\n.withColumn(\"Actor1Type2Code\", split($\"value\", \"\\\\t\").getItem(13))\n.withColumn(\"Actor1Type3Code\", split($\"value\", \"\\\\t\").getItem(14))\n.withColumn(\"Actor2Code\", split($\"value\", \"\\\\t\").getItem(15))\n.withColumn(\"Actor2Name\", split($\"value\", \"\\\\t\").getItem(16))\n.withColumn(\"Actor2CountryCode\", split($\"value\", \"\\\\t\").getItem(17))\n.withColumn(\"Actor2KnownGroupCode\", split($\"value\", \"\\\\t\").getItem(18))\n.withColumn(\"Actor2EthnicCode\", split($\"value\", \"\\\\t\").getItem(19))\n.withColumn(\"Actor2Religion1Code\", split($\"value\", \"\\\\t\").getItem(20))\n.withColumn(\"Actor2Religion2Code\", split($\"value\", \"\\\\t\").getItem(21))\n.withColumn(\"Actor2Type1Code\", split($\"value\", \"\\\\t\").getItem(22))\n.withColumn(\"Actor2Type2Code\", split($\"value\", \"\\\\t\").getItem(23))\n.withColumn(\"Actor2Type3Code\", split($\"value\", \"\\\\t\").getItem(24))\n.withColumn(\"IsRootEvent\", split($\"value\", \"\\\\t\").getItem(25))\n.withColumn(\"EventCode\", split($\"value\", \"\\\\t\").getItem(26))\n.withColumn(\"EventBaseCode\", split($\"value\", \"\\\\t\").getItem(27))\n.withColumn(\"EventRootCode\", split($\"value\", \"\\\\t\").getItem(28))\n.withColumn(\"QuadClass\", split($\"value\", \"\\\\t\").getItem(29))\n.withColumn(\"GoldsteinScale\", split($\"value\", \"\\\\t\").getItem(30))\n.withColumn(\"NumMentions\", split($\"value\", \"\\\\t\").getItem(31))\n.withColumn(\"NumSources\", split($\"value\", \"\\\\t\").getItem(32))\n.withColumn(\"NumArticles\", split($\"value\", \"\\\\t\").getItem(33))\n.withColumn(\"AvgTone\", split($\"value\", \"\\\\t\").getItem(34))\n.withColumn(\"Actor1Geo_Type\", split($\"value\", \"\\\\t\").getItem(35))\n.withColumn(\"Actor1Geo_FullName\", split($\"value\", \"\\\\t\").getItem(36))\n.withColumn(\"Actor1Geo_CountryCode\", split($\"value\", \"\\\\t\").getItem(37))\n.withColumn(\"Actor1Geo_ADM1Code\", split($\"value\", \"\\\\t\").getItem(38))\n.withColumn(\"Actor1Geo_ADM2Code\", split($\"value\", \"\\\\t\").getItem(39))\n.withColumn(\"Actor1Geo_Lat\", split($\"value\", \"\\\\t\").getItem(40))\n.withColumn(\"Actor1Geo_Long\", split($\"value\", \"\\\\t\").getItem(41))\n.withColumn(\"Actor1Geo_FeatureID\", split($\"value\", \"\\\\t\").getItem(42))\n.withColumn(\"Actor2Geo_Type\", split($\"value\", \"\\\\t\").getItem(43))\n.withColumn(\"Actor2Geo_FullName\", split($\"value\", \"\\\\t\").getItem(44))\n.withColumn(\"Actor2Geo_CountryCode\", split($\"value\", \"\\\\t\").getItem(45))\n.withColumn(\"Actor2Geo_ADM1Code\", split($\"value\", \"\\\\t\").getItem(46))\n.withColumn(\"Actor2Geo_ADM2Code\", split($\"value\", \"\\\\t\").getItem(47))\n.withColumn(\"Actor2Geo_Lat\", split($\"value\", \"\\\\t\").getItem(48))\n.withColumn(\"Actor2Geo_Long\", split($\"value\", \"\\\\t\").getItem(49))\n.withColumn(\"Actor2Geo_FeatureID\", split($\"value\", \"\\\\t\").getItem(50))\n.withColumn(\"ActionGeo_Type\", split($\"value\", \"\\\\t\").getItem(51))\n.withColumn(\"ActionGeo_FullName\", split($\"value\", \"\\\\t\").getItem(52))\n.withColumn(\"ActionGeo_CountryCode\", split($\"value\", \"\\\\t\").getItem(53))\n.withColumn(\"ActionGeo_ADM1Code\", split($\"value\", \"\\\\t\").getItem(54))\n.withColumn(\"ActionGeo_ADM2Code\", split($\"value\", \"\\\\t\").getItem(55))\n.withColumn(\"ActionGeo_Lat\", split($\"value\", \"\\\\t\").getItem(56))\n.withColumn(\"ActionGeo_Long\", split($\"value\", \"\\\\t\").getItem(57))\n.withColumn(\"ActionGeo_FeatureID\", split($\"value\", \"\\\\t\").getItem(58))\n.withColumn(\"DATEADDED\", split($\"value\", \"\\\\t\").getItem(59))\n.withColumn(\"SOURCEURL\", split($\"value\", \"\\\\t\").getItem(60))\n.drop($\"value\")\n","dateUpdated":"2020-01-17T08:17:00+0000","config":{"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"colWidth":12,"editorMode":"ace/mode/scala","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":195.994,"optionOpen":false}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.input.PortableDataStream\nimport java.util.zip.ZipInputStream\nimport java.io.BufferedReader\nimport java.io.InputStreamReader\ntextRDD_eng: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[37] at flatMap at <console>:54\ntextRDD_translate: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[39] at flatMap at <console>:52\neventDF: org.apache.spark.sql.DataFrame = [GLOBALEVENTID: string, Day: string ... 59 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579247674014_1302349793","id":"20171217-232457_1732696781","dateCreated":"2020-01-17T07:54:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1729","user":"anonymous","dateFinished":"2020-01-17T08:17:04+0000","dateStarted":"2020-01-17T08:17:00+0000"},{"text":"%md\n### GLOBAL KNOWLEDGE GRAPH","dateUpdated":"2020-01-17T07:54:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>GLOBAL KNOWLEDGE GRAPH</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247674016_1287729334","id":"20200111-162229_916549909","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1730"},{"text":"//exporter fichiers issus de masterfilelist.txt\nval gkgRDD_eng = sc.binaryFiles(\"/zeppelin/tmp/20181201[0-9]*.gkg.csv.zip\"). // charger quelques fichers via une regex   \n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\n\n//exporter fichiers issus de masterfilelist-translation.txt\nval gkgRDD_translate = sc.binaryFiles(\"/zeppelin/tmp/20181201[0-9]*.translation.gkg.csv.zip\").  \n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\n    \n//concaténer les RDD et transformer en DataFrame                                    \nval gkgDF = gkgRDD_eng.union(gkgRDD_translate).toDF()\n.withColumn(\"GKGRECORDID\", split($\"value\", \"\\\\t\").getItem(0))\n.withColumn(\"DATE\", split($\"value\", \"\\\\t\").getItem(1))\n.withColumn(\"SourceCollectionIdentifier\", split($\"value\", \"\\\\t\").getItem(2))\n.withColumn(\"SourceCommonName\", split($\"value\", \"\\\\t\").getItem(3))\n.withColumn(\"DocumentIdentifier\", split($\"value\", \"\\\\t\").getItem(4))\n.withColumn(\"Counts\", split($\"value\", \"\\\\t\").getItem(5))\n.withColumn(\"V2Counts\", split($\"value\", \"\\\\t\").getItem(6))\n.withColumn(\"Themes\", split($\"value\", \"\\\\t\").getItem(7))\n.withColumn(\"V2Themes\", split($\"value\", \"\\\\t\").getItem(8))\n.withColumn(\"Locations\", split($\"value\", \"\\\\t\").getItem(9))\n.withColumn(\"V2Locations\", split($\"value\", \"\\\\t\").getItem(10))\n.withColumn(\"Persons\", split($\"value\", \"\\\\t\").getItem(11))\n.withColumn(\"V2Persons\", split($\"value\", \"\\\\t\").getItem(12))\n.withColumn(\"Organizations\", split($\"value\", \"\\\\t\").getItem(13))\n.withColumn(\"V2Organizations\", split($\"value\", \"\\\\t\").getItem(14))\n.withColumn(\"V2Tone\", split($\"value\", \"\\\\t\").getItem(15))\n.withColumn(\"Dates\", split($\"value\", \"\\\\t\").getItem(16))\n.withColumn(\"GCAM\", split($\"value\", \"\\\\t\").getItem(17))\n.withColumn(\"SharingImage\", split($\"value\", \"\\\\t\").getItem(18))\n.withColumn(\"RelatedImages\", split($\"value\", \"\\\\t\").getItem(19))\n.withColumn(\"SocialImageEmbeds\", split($\"value\", \"\\\\t\").getItem(20))\n.withColumn(\"SocialVideoEmbeds\", split($\"value\", \"\\\\t\").getItem(21))\n.withColumn(\"Quotations\", split($\"value\", \"\\\\t\").getItem(22))\n.withColumn(\"AllNames\", split($\"value\", \"\\\\t\").getItem(23))\n.withColumn(\"Amounts\", split($\"value\", \"\\\\t\").getItem(24))\n.withColumn(\"TranslationInfo\", split($\"value\", \"\\\\t\").getItem(25))\n.withColumn(\"Extras\", split($\"value\", \"\\\\t\").getItem(26))\n.drop($\"value\")","dateUpdated":"2020-01-17T08:05:25+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"gkgRDD_eng: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[27] at flatMap at <console>:37\ngkgRDD_translate: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[29] at flatMap at <console>:38\ngkgDF: org.apache.spark.sql.DataFrame = [GKGRECORDID: string, DATE: string ... 25 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579247674017_1287344586","id":"20200111-160038_1308018681","dateCreated":"2020-01-17T07:54:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1731","user":"anonymous","dateFinished":"2020-01-17T08:05:28+0000","dateStarted":"2020-01-17T08:05:25+0000"},{"text":"%md\n### MENTION ","dateUpdated":"2020-01-17T07:54:34+0000","config":{"tableHide":true,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>MENTION</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247674018_1288498832","id":"20200111-161729_1436776043","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1732"},{"text":"//exporter fichiers issus de masterfilelist.txt\nval mentionRDD_eng = sc.binaryFiles(\"/zeppelin/tmp/20181201[0-9]*.mentions.CSV.zip\").   \n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\n    \n//exporter fichiers issus de masterfilelist-translation.txt\nval mentionRDD_translate = sc.binaryFiles(\"/zeppelin/tmp/20181201[0-9]*.translation.mentions.CSV.zip\"). \n   flatMap {  // decompresser les fichiers\n       case (name: String, content: PortableDataStream) =>\n          val zis = new ZipInputStream(content.open)\n          Stream.continually(zis.getNextEntry).\n                takeWhile(_ != null).\n                flatMap { _ =>\n                    val br = new BufferedReader(new InputStreamReader(zis))\n                    Stream.continually(br.readLine()).takeWhile(_ != null)\n                }\n    }\n    \n//concaténer les RDD et transformer en DataFrame\nval mentionDF = mentionRDD_eng.union(mentionRDD_translate).toDF()\n.withColumn(\"GLOBALEVENTID\", split($\"value\", \"\\\\t\").getItem(0))\n.withColumn(\"EventTimeDate\", split($\"value\", \"\\\\t\").getItem(1))\n.withColumn(\"MentionTimeDate\", split($\"value\", \"\\\\t\").getItem(2))\n.withColumn(\"MentionType\", split($\"value\", \"\\\\t\").getItem(3))\n.withColumn(\"MentionSourceName\", split($\"value\", \"\\\\t\").getItem(4))\n.withColumn(\"MentionIdentifier\", split($\"value\", \"\\\\t\").getItem(5))\n.withColumn(\"SentenceID\", split($\"value\", \"\\\\t\").getItem(6))\n.withColumn(\"Actor1CharOffset\", split($\"value\", \"\\\\t\").getItem(7))\n.withColumn(\"Actor2CharOffset\", split($\"value\", \"\\\\t\").getItem(8))\n.withColumn(\"ActionCharOffset\", split($\"value\", \"\\\\t\").getItem(9))\n.withColumn(\"InRawText\", split($\"value\", \"\\\\t\").getItem(10))\n.withColumn(\"Confidence\", split($\"value\", \"\\\\t\").getItem(11))\n.withColumn(\"MentionDocLen\", split($\"value\", \"\\\\t\").getItem(12))\n.withColumn(\"MentionDocTone\", split($\"value\", \"\\\\t\").getItem(13))\n.withColumn(\"MentionDocTranslationInfo\", split($\"value\", \"\\\\t\").getItem(14))\n.withColumn(\"Extras\", split($\"value\", \"\\\\t\").getItem(15))\n.withColumn(\"Langue_1\", when (col(\"MentionDocTranslationInfo\") === \"\", \":eng\").otherwise(col(\"MentionDocTranslationInfo\")))    /// les lignes suivante concernent la Tramsformation de la colonne MentionDocTranslationInfo\n.withColumn(\"Langue_2\", split($\"Langue_1\", \";\").getItem(0))\n.withColumn(\"Langue\", split($\"Langue_2\", \":\").getItem(1))\n.drop($\"Langue_1\")\n.drop($\"Langue_2\")\n.drop($\"value\")\n//.drop($\"MentionDocTranslationInfo\")  à supprimer une fois le groupe convaincu que la transformation de la colonne fonctionne\n","dateUpdated":"2020-01-17T09:06:31+0000","config":{"tableHide":true,"editorSetting":{"language":"scala","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/scala","editorHide":false,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"mentionRDD_eng: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[13] at flatMap at <console>:37\nmentionRDD_translate: org.apache.spark.rdd.RDD[String] = MapPartitionsRDD[15] at flatMap at <console>:38\nmentionDF: org.apache.spark.sql.DataFrame = [GLOBALEVENTID: string, EventTimeDate: string ... 15 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579247674018_1288498832","id":"20200111-162803_300481733","dateCreated":"2020-01-17T07:54:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1733","user":"anonymous","dateFinished":"2020-01-17T08:04:19+0000","dateStarted":"2020-01-17T08:04:14+0000"},{"text":"mentionDF.select(\"MentionDocTranslationInfo\",\"Langue\").distinct.show()      // piste d'amélioration : trouver ou créer un dico key/value pour remplacer le sigle par la langue full name   . De Mëme pour les pays","dateUpdated":"2020-01-17T08:17:52+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------------+------+\n|MentionDocTranslationInfo|Langue|\n+-------------------------+------+\n|     srclc:dan;eng:GT-...|   dan|\n|     srclc:swe;eng:GT-...|   swe|\n|     srclc:ces;eng:Mos...|   ces|\n|     srclc:spa;eng:Mos...|   spa|\n|     srclc:kat;eng:GT-...|   kat|\n|     srclc:tur;eng:GT-...|   tur|\n|     srclc:urd;eng:GT-...|   urd|\n|     srclc:rus;eng:GT-...|   rus|\n|     srclc:est;eng:Mos...|   est|\n|     srclc:som;eng:GT-...|   som|\n|     srclc:ita;eng:GT-...|   ita|\n|     srclc:nld;eng:GT-...|   nld|\n|     srclc:lit;eng:GT-...|   lit|\n|     srclc:bul;eng:GT-...|   bul|\n|     srclc:ben;eng:GT-...|   ben|\n|     srclc:tel;eng:GT-...|   tel|\n|     srclc:spa;eng:GT-...|   spa|\n|     srclc:hrv;eng:GT-...|   hrv|\n|     srclc:fas;eng:GT-...|   fas|\n|     srclc:fra;eng:GT-...|   fra|\n+-------------------------+------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1579247674018_1288498832","id":"20200116-200330_122564667","dateCreated":"2020-01-17T07:54:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1734","user":"anonymous","dateFinished":"2020-01-17T08:18:23+0000","dateStarted":"2020-01-17T08:17:52+0000"},{"text":"// on réduit d'abord le nombre de colonnes sur chaque DF avant d'effectuer le join pour améliorer les performances \n\nval eventDF_selected  = eventDF.select(\"GLOBALEVENTID\",\"Day\",\"MonthYear\",\"Year\",\"Actor1Name\",\"Actor1CountryCode\",\"Actor2Name\",\"Actor2CountryCode\",\"NumMentions\",\"NumArticles\",\"AvgTone\",\"ActionGeo_FullName\",\"ActionGeo_CountryCode\").cache()\n\nval gkgDF_selected = gkgDF.select(\"GKGRECORDID\",\"DATE\",\"SourceCommonName\",\"DocumentIdentifier\",\"V2Themes\",\"V2Locations\",\"V2Persons\",\"Organizations\",\"V2Tone\",\"TranslationInfo\").cache()\n\nval mentionDF_selected = mentionDF.select(\"GLOBALEVENTID\",\"EventTimeDate\",\"MentionTimeDate\",\"MentionSourceName\",\"MentionIdentifier\",\"MentionDocTone\",\"MentionDocTranslationInfo\",\"Langue\").cache()\n\n \n//JOIN eventDF_selected with mentionDF_selected ON GLOBALEVENTID   \nval event_mention_DF = eventDF_selected.join(mentionDF_selected,\"GlobalEventID\").cache()       // is the .cache() effective here? TBC\n\n//JOIN gkgDF_selected with mentionDF_selected ON DocumentIdentifier = MentionIdentifier \nval mention_gkg_DF = mentionDF_selected.join(gkgDF_selected, mentionDF_selected(\"MentionIdentifier\") ===  gkgDF_selected(\"DocumentIdentifier\")).cache()\n\n//JOIN eventDF_selected with mention_gkg_DF ON GLOBALEVENTID \nval event_mention_gkg_DF = mention_gkg_DF.join(eventDF_selected,\"GlobalEventID\").cache()","dateUpdated":"2020-01-17T20:26:17+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"eventDF_selected: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [GLOBALEVENTID: string, Day: string ... 11 more fields]\ngkgDF_selected: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [GKGRECORDID: string, DATE: string ... 8 more fields]\nmentionDF_selected: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [GLOBALEVENTID: string, EventTimeDate: string ... 6 more fields]\nevent_mention_DF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [GLOBALEVENTID: string, Day: string ... 18 more fields]\nmention_gkg_DF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [GLOBALEVENTID: string, EventTimeDate: string ... 16 more fields]\nevent_mention_gkg_DF: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [GLOBALEVENTID: string, EventTimeDate: string ... 28 more fields]\n"}]},"apps":[],"jobName":"paragraph_1579247674019_1288114083","id":"20200111-163126_611491370","dateCreated":"2020-01-17T07:54:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1735","user":"anonymous","dateFinished":"2020-01-17T20:26:18+0000","dateStarted":"2020-01-17T20:26:17+0000"},{"text":"//essai avec un filtre\nevent_mention_DF.filter(\"ActionGeo_CountryCode == 'US'\").distinct.show()","dateUpdated":"2020-01-17T08:18:32+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579247674019_1288114083","id":"20200116-210026_1719925702","dateCreated":"2020-01-17T07:54:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1736","user":"anonymous","dateFinished":"2020-01-17T08:19:37+0000","dateStarted":"2020-01-17T08:18:33+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+--------+---------+----+----------+-----------------+----------+-----------------+-----------+-----------+-----------------+--------------------+---------------------+--------------+---------------+--------------------+-----------------+-------------------------+------+\n|GLOBALEVENTID|     Day|MonthYear|Year|Actor1Name|Actor1CountryCode|Actor2Name|Actor2CountryCode|NumMentions|NumArticles|          AvgTone|  ActionGeo_FullName|ActionGeo_CountryCode| EventTimeDate|MentionTimeDate|   MentionSourceName|   MentionDocTone|MentionDocTranslationInfo|Langue|\n+-------------+--------+---------+----+----------+-----------------+----------+-----------------+-----------+-----------+-----------------+--------------------+---------------------+--------------+---------------+--------------------+-----------------+-------------------------+------+\n|    806754408|20181201|   201812|2018|          |                 |     VOTER|                 |          6|          6|-3.91061452513966|Broward County, F...|                   US|20181201000000| 20181201001500|        mynews13.com|-3.91061452513966|                         |   eng|\n|    806754408|20181201|   201812|2018|          |                 |     VOTER|                 |          6|          6|-3.91061452513966|Broward County, F...|                   US|20181201000000| 20181201000000|        baynews9.com|-3.91061452513966|                         |   eng|\n|    806755131|20181201|   201812|2018|  INDUSTRY|                 |  NEW YORK|              USA|         10|         10|  2.3121387283237|New York, United ...|                   US|20181201000000| 20181201054500|            wral.com| -1.0228166797797|                         |   eng|\n|    806755131|20181201|   201812|2018|  INDUSTRY|                 |  NEW YORK|              USA|         10|         10|  2.3121387283237|New York, United ...|                   US|20181201000000| 20181201114500|    readingeagle.com| 0.69204152249135|                         |   eng|\n|    806755131|20181201|   201812|2018|  INDUSTRY|                 |  NEW YORK|              USA|         10|         10|  2.3121387283237|New York, United ...|                   US|20181201000000| 20181201000000|     therealdeal.com|  2.3121387283237|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201013000| ccenterdispatch.com|-4.05405405405405|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201043000|            wtop.com|-3.55029585798817|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201003000|            ktbs.com|-4.05405405405405|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201164500|           chron.com|-4.05405405405405|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201033000|            ktar.com| -3.6144578313253|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201020000| am1070theanswer.com|-3.52941176470588|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201213000|      timesunion.com|-4.05405405405405|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201213000|          ctpost.com|-4.05405405405405|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201093000|          nbcdfw.com|-3.57142857142857|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201160000|          sfgate.com|-4.05405405405405|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201001500|brownsvilleherald...|-4.05405405405405|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201051500|            wrex.com|-4.05405405405405|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201051500|    citynews1130.com|               -4|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201051500|     660citynews.com|               -4|                         |   eng|\n|    806757087|20181201|   201812|2018|      ARMY|                 |    PRISON|                 |          1|          1|-4.05405405405405|San Antonio, Texa...|                   US|20181201000000| 20181201051500|            waow.com|-4.05405405405405|                         |   eng|\n+-------------+--------+---------+----+----------+-----------------+----------+-----------------+-----------+-----------+-----------------+--------------------+---------------------+--------------+---------------+--------------------+-----------------+-------------------------+------+\nonly showing top 20 rows\n\n"}]}},{"text":"%md\n### REQUETES","dateUpdated":"2020-01-17T07:54:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>REQUETES</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247674019_1288114083","id":"20200116-203741_1375339315","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1737"},{"text":"%md\n### 1) afficher le nombre d’articles/évènements qu’il y a eu pour chaque triplet (jour, pays de l’évènement, langue de l’article).","dateUpdated":"2020-01-17T07:54:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>1) afficher le nombre d’articles/évènements qu’il y a eu pour chaque triplet (jour, pays de l’évènement, langue de l’article).</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247674020_1286190339","id":"20200116-204114_684716828","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1738"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579267728921_438881987","id":"20200117-132848_573891968","dateCreated":"2020-01-17T13:28:48+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5440","text":"val question1Dfbis_countdistinct = event_mention_DF\n.filter($\"ActionGeo_CountryCode\" !== \"\")\n.groupBy(\"ActionGeo_CountryCode\", \"Day\", \"Langue\",\"GLOBALEVENTID\")\n.agg(countDistinct($\"MentionIdentifier\") as \"distinct_count\")   //regarder la difference avec count() ci dessous  \n.sort($\"distinct_count\".desc)\n.show()\n","dateUpdated":"2020-01-17T13:48:10+0000","dateFinished":"2020-01-17T13:48:12+0000","dateStarted":"2020-01-17T13:48:10+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n+---------------------+--------+------+-------------+--------------+\n|ActionGeo_CountryCode|     Day|Langue|GLOBALEVENTID|distinct_count|\n+---------------------+--------+------+-------------+--------------+\n|                   US|20181201|   eng|    806800959|          1117|\n|                   US|20181201|   eng|    806754650|           952|\n|                   US|20181201|   eng|    806757901|           902|\n|                   US|20181201|   eng|    806757889|           870|\n|                   US|20181201|   eng|    806757864|           812|\n|                   US|20181201|   eng|    806757704|           784|\n|                   IR|20181201|   eng|    806829379|           647|\n|                   IR|20181201|   eng|    806829257|           647|\n|                   US|20181201|   eng|    806757863|           631|\n|                   FR|20181201|   eng|    806849161|           582|\n|                   US|20181201|   eng|    806818336|           547|\n|                   FR|20181201|   eng|    806837068|           546|\n|                   AR|20181201|   eng|    806754811|           538|\n|                   FR|20181201|   eng|    806836065|           534|\n|                   MX|20181201|   eng|    806769030|           526|\n|                   US|20181201|   eng|    806818353|           525|\n|                   MX|20181201|   eng|    806818335|           524|\n|                   US|20181201|   eng|    806818354|           523|\n|                   US|20181201|   eng|    806820357|           520|\n|                   US|20181201|   eng|    806757970|           504|\n+---------------------+--------+------+-------------+--------------+\nonly showing top 20 rows\n\nquestion1Dfbis_countdistinct: Unit = ()\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579268054795_-877483563","id":"20200117-133414_267413105","dateCreated":"2020-01-17T13:34:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5574","text":"val question1Dfbis_count = event_mention_DF\n.filter($\"ActionGeo_CountryCode\" !== \"\")\n.groupBy(\"ActionGeo_CountryCode\", \"Day\", \"Langue\",\"GLOBALEVENTID\")\n.count()   \n.sort($\"count\".desc)\n.show()                                                  // on voit que les valeurs de la colonne count est ici beaucoup plus eleve que dans la colonne distinct_count au dessus.  Pourquoi ? Reponse dans la requete ci-dessous","dateUpdated":"2020-01-17T13:48:17+0000","dateFinished":"2020-01-17T13:48:18+0000","dateStarted":"2020-01-17T13:48:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\n+---------------------+--------+------+-------------+-----+\n|ActionGeo_CountryCode|     Day|Langue|GLOBALEVENTID|count|\n+---------------------+--------+------+-------------+-----+\n|                   MX|20181201|   eng|    806769030| 2098|\n|                   US|20181201|   eng|    806757863| 1158|\n|                   US|20181201|   eng|    806800959| 1117|\n|                   FR|20181201|   eng|    806836065| 1070|\n|                   IS|20181201|   ara|    806764378| 1020|\n|                   US|20181201|   eng|    806754650|  959|\n|                   IS|20181201|   ara|    806764116|  912|\n|                   US|20181201|   eng|    806757901|  909|\n|                   US|20181201|   eng|    806756120|  904|\n|                   US|20181201|   eng|    806757889|  874|\n|                   AR|20181201|   eng|    806754807|  823|\n|                   US|20181201|   eng|    806757864|  814|\n|                   US|20181201|   eng|    806757704|  785|\n|                   GZ|20181201|   ara|    806764301|  764|\n|                   GZ|20181201|   ara|    806764302|  764|\n|                   IS|20181201|   ara|    806763423|  720|\n|                   RS|20181201|   eng|    806839525|  704|\n|                   US|20181201|   eng|    806758021|  694|\n|                   IS|20181201|   ara|    806764384|  684|\n|                   NG|20181201|   fra|    806764257|  684|\n+---------------------+--------+------+-------------+-----+\nonly showing top 20 rows\n\nquestion1Dfbis_count: Unit = ()\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579268420366_1812633130","id":"20200117-134020_1678575110","dateCreated":"2020-01-17T13:40:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5741","text":"//C'est parcequ'un evenement peut etre mentionne plusieurs fois dans un meme article comme le montre cette requete, ce qui fausse le resultat \n//il faudra donc faire un count distinct sur \"Mentionidentifier\" pour compter le nombre d'articles et pas le nombres de mentions\n\nval mention_par_event_df = event_mention_DF.groupBy(\"GLOBALEVENTID\",\"MentionIdentifier\").count().sort($\"count\".desc).show()   ","dateUpdated":"2020-01-17T13:48:21+0000","dateFinished":"2020-01-17T13:48:22+0000","dateStarted":"2020-01-17T13:48:21+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+--------------------+-----+\n|GLOBALEVENTID|   MentionIdentifier|count|\n+-------------+--------------------+-----+\n|    806892895|https://www.unser...|    8|\n|    806807492|https://www.em.co...|    8|\n|    806807492|http://jornaldesa...|    8|\n|    806807492|http://noticias.u...|    8|\n|    806807492|https://exame.abr...|    8|\n|    806873674|http://www.die-gl...|    8|\n|    806848525|https://www.dosto...|    8|\n|    806873674|http://www.die-gl...|    8|\n|    806763468|https://de.eurone...|    8|\n|    806807492|https://www.istoe...|    8|\n|    806912567|https://www.notiz...|    8|\n|    806916366|https://www.tayya...|    8|\n|    806873674|http://www.celles...|    8|\n|    806873674|https://www.focus...|    8|\n|    806805293|https://impresa.p...|    8|\n|    806873674|https://www.finan...|    8|\n|    806873674|https://www.thuer...|    8|\n|    806873674|https://www.szlz....|    8|\n|    806873674|https://www.pnp.d...|    8|\n|    806883580|https://www.kuwai...|    8|\n+-------------+--------------------+-----+\nonly showing top 20 rows\n\nmention_par_event_df: Unit = ()\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579268228583_-1432448007","id":"20200117-133708_1187163731","dateCreated":"2020-01-17T13:37:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5685","text":"val question1Df = event_mention_DF\n.filter($\"ActionGeo_CountryCode\" !== \"\")\n.groupBy(\"ActionGeo_CountryCode\", \"Day\", \"Langue\",\"GLOBALEVENTID\")\n.agg(countDistinct($\"MentionIdentifier\") as \"distinct_count\") \n\n\nval question1DfFinal = question1Df.select(\"Day\",\"ActionGeo_CountryCode\",\"Langue\",\"GLOBALEVENTID\",\"distinct_count\")\n.withColumnRenamed(\"Day\", \"jour\")\n.withColumnRenamed(\"ActionGeo_CountryCode\", \"pays\")                                                                             //FIPS10-4 Country code dictionnary\n.withColumnRenamed(\"Langue\", \"langue_article\")\n.withColumnRenamed(\"GLOBALEVENTID\", \"evenement\")\n.withColumnRenamed(\"distinct_count\", \"nombre_article\")\n.sort($\"jour\".asc)                                                                                                              // WHY SEVERAL DAY ?? I thought we only had one day of data\n\nquestion1DfFinal.show()","dateUpdated":"2020-01-17T13:48:24+0000","dateFinished":"2020-01-17T13:48:28+0000","dateStarted":"2020-01-17T13:48:24+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nquestion1Df: org.apache.spark.sql.DataFrame = [ActionGeo_CountryCode: string, Day: string ... 3 more fields]\nquestion1DfFinal: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [jour: string, pays: string ... 3 more fields]\n+--------+----+--------------+---------+--------------+\n|    jour|pays|langue_article|evenement|nombre_article|\n+--------+----+--------------+---------+--------------+\n|20081203|  US|           eng|806905069|             1|\n|20081203|  US|           eng|806764657|             1|\n|20081203|  AS|           eng|806948008|             1|\n|20081203|  SY|           eng|806948007|             1|\n|20081203|  KU|           eng|806918623|             1|\n|20081203|  UP|           eng|806769083|             1|\n|20081203|  IT|           ita|806874855|             1|\n|20081203|  IN|           eng|806858504|             1|\n|20081203|  US|           eng|806908907|             1|\n|20081203|  US|           eng|806783346|             1|\n|20081203|  US|           eng|806908905|             1|\n|20081203|  IT|           eng|806807799|             1|\n|20081203|  SP|           eng|806769084|             1|\n|20081203|  US|           eng|806799728|             1|\n|20081203|  US|           eng|806908906|             1|\n|20081203|  CH|           eng|806841457|             1|\n|20081203|  US|           eng|806799727|             2|\n|20081203|  UK|           eng|806879421|             8|\n|20081203|  UK|           eng|806879422|             8|\n|20081203|  US|           eng|806807798|             1|\n+--------+----+--------------+---------+--------------+\nonly showing top 20 rows\n\n"}]}},{"text":"//CASSANDRA\nquestion1DfFinal.write.option(\"header\", \"true\").csv(\"/zeppelin/tmp/question_1_clean.csv\")\n//question1DfFinal.write.cassandraFormat(\"table\", \"gdelt\").save()","dateUpdated":"2020-01-17T07:54:34+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1579247674020_1286190339","id":"20200116-211002_733855943","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1740"},{"text":"%md \n### 2) Pour un pays donné en paramètre, affichez les évènements qui y ont eu place triées par le nombre de mentions (tri décroissant); permettez une agrégation par jour/mois/année","dateUpdated":"2020-01-17T07:54:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>2) Pour un pays donné en paramètre, affichez les évènements qui y ont eu place triées par le nombre de mentions (tri décroissant); permettez une agrégation par jour/mois/année</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247674021_1285805590","id":"20200116-204259_1718312652","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1741"},{"text":"//choisir soit ActionGeo_CountryCode soit ActionGeo_FullName\n// Df avec colonne dans l'ordre\nval question2Df = event_mention_DF.select(\"ActionGeo_CountryCode\",\"Day\",\"MonthYear\",\"Year\",\"GLOBALEVENTID\")   //peut être que MentionTimeDate n'est pas nécessaire mais pratique pour distinguer les mentions pour un même event\n.filter($\"ActionGeo_CountryCode\" !== \"\")\n.groupBy(\"ActionGeo_CountryCode\",\"Day\",\"MonthYear\",\"Year\",\"GLOBALEVENTID\")  \n.count()                                                                                 //ici on veut le nombre de mentions et pas le nombre d'articles, donc .count() est correct\n//.show()\n\n\nval question2DfFinal = question2Df                                                     \n.withColumnRenamed(\"Day\", \"jour\")\n.withColumnRenamed(\"ActionGeo_CountryCode\", \"pays\")\n.withColumnRenamed(\"count\", \"nombre_mentions\")\n.sort($\"GLOBALEVENTID\".desc) \n\nquestion2DfFinal.show()","dateUpdated":"2020-01-17T14:17:15+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one deprecation warning; re-run with -deprecation for details\nquestion2Df: org.apache.spark.sql.DataFrame = [ActionGeo_CountryCode: string, Day: string ... 4 more fields]\nquestion2DfFinal: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [pays: string, jour: string ... 4 more fields]\n+----+--------+---------+----+-------------+---------------+\n|pays|    jour|MonthYear|Year|GLOBALEVENTID|nombre_mentions|\n+----+--------+---------+----+-------------+---------------+\n|  IR|20181201|   201812|2018|    806958356|              4|\n|  VT|20181201|   201812|2018|    806958355|              4|\n|  SP|20181201|   201812|2018|    806958354|              4|\n|  VE|20181201|   201812|2018|    806958353|              4|\n|  BA|20181201|   201812|2018|    806958352|              4|\n|  RS|20181201|   201812|2018|    806958351|              4|\n|  RS|20181201|   201812|2018|    806958350|              4|\n|  US|20181201|   201812|2018|    806958349|              4|\n|  US|20181201|   201812|2018|    806958348|              4|\n|  US|20181201|   201812|2018|    806958347|              4|\n|  UP|20181201|   201812|2018|    806958346|              4|\n|  US|20181201|   201812|2018|    806958345|              4|\n|  UP|20181201|   201812|2018|    806958344|              4|\n|  GM|20181201|   201812|2018|    806958343|              4|\n|  US|20181201|   201812|2018|    806958342|              4|\n|  US|20181201|   201812|2018|    806958341|              4|\n|  US|20181201|   201812|2018|    806958340|              4|\n|  UP|20181201|   201812|2018|    806958339|              4|\n|  GM|20181201|   201812|2018|    806958338|              4|\n|  SP|20181201|   201812|2018|    806958337|              4|\n+----+--------+---------+----+-------------+---------------+\nonly showing top 20 rows\n\n"}]},"apps":[],"jobName":"paragraph_1579247674021_1285805590","id":"20200115-201647_183260547","dateCreated":"2020-01-17T07:54:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1742","user":"anonymous","dateFinished":"2020-01-17T14:17:16+0000","dateStarted":"2020-01-17T14:17:15+0000"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579270659429_-1171909537","id":"20200117-141739_1890093786","dateCreated":"2020-01-17T14:17:39+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6457","text":"val q2= question2DfFinal.filter(\"ActionGeo_CountryCode == 'US'\").show()","dateUpdated":"2020-01-17T14:18:30+0000","dateFinished":"2020-01-17T14:18:32+0000","dateStarted":"2020-01-17T14:18:30+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+--------+---------+----+-------------+---------------+\n|pays|    jour|MonthYear|Year|GLOBALEVENTID|nombre_mentions|\n+----+--------+---------+----+-------------+---------------+\n|  US|20181201|   201812|2018|    806958349|              4|\n|  US|20181201|   201812|2018|    806958348|              4|\n|  US|20181201|   201812|2018|    806958347|              4|\n|  US|20181201|   201812|2018|    806958345|              4|\n|  US|20181201|   201812|2018|    806958342|              4|\n|  US|20181201|   201812|2018|    806958341|              4|\n|  US|20181201|   201812|2018|    806958340|              4|\n|  US|20181201|   201812|2018|    806958309|              4|\n|  US|20181201|   201812|2018|    806958303|              4|\n|  US|20181201|   201812|2018|    806958299|              4|\n|  US|20181201|   201812|2018|    806958298|              4|\n|  US|20181201|   201812|2018|    806958258|              4|\n|  US|20181201|   201812|2018|    806958255|              4|\n|  US|20181201|   201812|2018|    806958249|              4|\n|  US|20181201|   201812|2018|    806958233|              4|\n|  US|20181201|   201812|2018|    806958232|              4|\n|  US|20181201|   201812|2018|    806958226|              4|\n|  US|20181201|   201812|2018|    806958195|              4|\n|  US|20181201|   201812|2018|    806958185|              4|\n|  US|20181201|   201812|2018|    806958184|              4|\n+----+--------+---------+----+-------------+---------------+\nonly showing top 20 rows\n\nq2: Unit = ()\n"}]}},{"text":"//CASSANDRA\nquestion2DfFinal.write.option(\"header\", \"true\").csv(\"/zeppelin/tmp/question_2_clean.csv\")","dateUpdated":"2020-01-17T07:54:34+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1579247674021_1285805590","id":"20200116-215311_198608266","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1743"},{"text":"//test\n//requete :  remplacer IN par un autre pays,   // count number of articles per globaleventid\nval q2= question2Df.filter(\"ActionGeo_CountryCode == 'IN'\").groupBy(\"GLOBALEVENTID\",\"Day\").agg(\n    expr(\"count(MentionTimeDate) as Nombre_Article\")).sort($\"Nombre_Article\".desc) \n\n//reordonner les colonnes\nval test_ordered = q2.select(\"GLOBALEVENTID\",\"Nombre_Article\",\"Day\")\ntest_ordered.show\n","dateUpdated":"2020-01-17T07:54:34+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579247674022_1286959837","id":"20200116-214259_1993738308","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1744"},{"text":"%md\n### 3) Pour une source de donnés passée en paramètre (gkg.SourceCommonName) affichez les thèmes, personnes, lieux dont les articles de cette sources parlent ainsi que le nombre d’articles et le ton moyen des articles (pour chaque thème/personne/lieu); permettez une agrégation par jour/mois/année.","dateUpdated":"2020-01-17T11:16:58+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>3) Pour une source de donnés passée en paramètre (gkg.SourceCommonName) affichez les thèmes, personnes, lieux dont les articles de cette sources parlent ainsi que le nombre d’articles et le ton moyen des articles (pour chaque thème/personne/lieu); permettez une agrégation par jour/mois/année.</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247674022_1286959837","id":"20200116-204344_362751402","dateCreated":"2020-01-17T07:54:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:1745","user":"anonymous","dateFinished":"2020-01-17T11:17:00+0000","dateStarted":"2020-01-17T11:16:58+0000"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579283236773_443517669","id":"20200117-174716_1766664719","dateCreated":"2020-01-17T17:47:16+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7419","text":"val question3Df_person = gkgDF_selected.select(\"SourceCommonName\",\"DocumentIdentifier\",\"V2Persons\",\"V2Tone\")\n.withColumn(\"Persons_split\", split($\"V2Persons\", \";\"))\n.withColumn(\"Persons_unique\",explode($\"Persons_split\"))\n.withColumn(\"Persons\", split($\"Persons_unique\", \",\").getItem(0))\n.drop($\"Persons_split\")\n.drop($\"Persons_unique\")\n.drop($\"V2Persons\")\n.sort($\"V2Tone\")\n.show()\n\n//val question3Df_person_concat = question3Df_person.groupBy($\"SouceCommonName\").agg(GroupConcat($\"Persons\")).show","dateUpdated":"2020-01-17T20:26:54+0000","dateFinished":"2020-01-17T20:29:15+0000","dateStarted":"2020-01-17T20:26:54+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.SparkException: Job 85 cancelled part of cancelled job group zeppelin-20200117-174716_1766664719\n  at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1435)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobCancellation(DAGScheduler.scala:1375)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply$mcVI$sp(DAGScheduler.scala:788)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:788)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:788)\n  at scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobGroupCancelled(DAGScheduler.scala:788)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1625)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1605)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1594)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:1918)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:1981)\n  at org.apache.spark.rdd.RDD$$anonfun$reduce$1.apply(RDD.scala:1025)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n  at org.apache.spark.rdd.RDD.reduce(RDD.scala:1007)\n  at org.apache.spark.rdd.RDD$$anonfun$takeOrdered$1.apply(RDD.scala:1428)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:151)\n  at org.apache.spark.rdd.RDDOperationScope$.withScope(RDDOperationScope.scala:112)\n  at org.apache.spark.rdd.RDD.withScope(RDD.scala:362)\n  at org.apache.spark.rdd.RDD.takeOrdered(RDD.scala:1415)\n  at org.apache.spark.sql.execution.TakeOrderedAndProjectExec.executeCollect(limit.scala:133)\n  at org.apache.spark.sql.Dataset$$anonfun$org$apache$spark$sql$Dataset$$execute$1$1.apply(Dataset.scala:2371)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:57)\n  at org.apache.spark.sql.Dataset.withNewExecutionId(Dataset.scala:2765)\n  at org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$execute$1(Dataset.scala:2370)\n  at org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collect(Dataset.scala:2377)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2113)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2112)\n  at org.apache.spark.sql.Dataset.withTypedCallback(Dataset.scala:2795)\n  at org.apache.spark.sql.Dataset.head(Dataset.scala:2112)\n  at org.apache.spark.sql.Dataset.take(Dataset.scala:2327)\n  at org.apache.spark.sql.Dataset.showString(Dataset.scala:248)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:636)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:595)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:604)\n  ... 50 elided\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579288098924_836676252","id":"20200117-190818_375052846","dateCreated":"2020-01-17T19:08:18+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8147","text":"val question3Df_themes = gkgDF_selected.select(\"SourceCommonName\",\"DocumentIdentifier\",\"V2Themes\",\"V2Tone\")\n.withColumn(\"Themes_split\", split($\"V2Themes\", \";\"))\n.withColumn(\"themes_unique\",explode($\"Themes_split\"))\n.drop($\"Themes_split\")\n.drop($\"V2Themes\")\n","dateUpdated":"2020-01-17T20:38:35+0000","dateFinished":"2020-01-17T20:38:35+0000","dateStarted":"2020-01-17T20:38:35+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"question3Df_themes: org.apache.spark.sql.DataFrame = [SourceCommonName: string, DocumentIdentifier: string ... 2 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579283523148_1101840529","id":"20200117-175203_742528206","dateCreated":"2020-01-17T17:52:03+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7475","text":"\nval question3Df_themes_collected = question3Df_themes\n.groupBy(\"SourceCommonName\", \"DocumentIdentifier\",\"V2Tone\")\n.agg(collect_set(\"Themes_unique\") as \"Themes_collection\")\n.show()\n\n\n","dateUpdated":"2020-01-17T20:38:56+0000","dateFinished":"2020-01-17T20:48:12+0000","dateStarted":"2020-01-17T20:38:56+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.SparkException: Job 88 cancelled part of cancelled job group zeppelin-20200117-175203_742528206\n  at org.apache.spark.scheduler.DAGScheduler.org$apache$spark$scheduler$DAGScheduler$$failJobAndIndependentStages(DAGScheduler.scala:1435)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobCancellation(DAGScheduler.scala:1375)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply$mcVI$sp(DAGScheduler.scala:788)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:788)\n  at org.apache.spark.scheduler.DAGScheduler$$anonfun$handleJobGroupCancelled$1.apply(DAGScheduler.scala:788)\n  at scala.collection.mutable.HashSet.foreach(HashSet.scala:78)\n  at org.apache.spark.scheduler.DAGScheduler.handleJobGroupCancelled(DAGScheduler.scala:788)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.doOnReceive(DAGScheduler.scala:1625)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1605)\n  at org.apache.spark.scheduler.DAGSchedulerEventProcessLoop.onReceive(DAGScheduler.scala:1594)\n  at org.apache.spark.util.EventLoop$$anon$1.run(EventLoop.scala:48)\n  at org.apache.spark.scheduler.DAGScheduler.runJob(DAGScheduler.scala:628)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:1918)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:1931)\n  at org.apache.spark.SparkContext.runJob(SparkContext.scala:1944)\n  at org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:333)\n  at org.apache.spark.sql.execution.CollectLimitExec.executeCollect(limit.scala:38)\n  at org.apache.spark.sql.Dataset$$anonfun$org$apache$spark$sql$Dataset$$execute$1$1.apply(Dataset.scala:2371)\n  at org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:57)\n  at org.apache.spark.sql.Dataset.withNewExecutionId(Dataset.scala:2765)\n  at org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$execute$1(Dataset.scala:2370)\n  at org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$collect(Dataset.scala:2377)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2113)\n  at org.apache.spark.sql.Dataset$$anonfun$head$1.apply(Dataset.scala:2112)\n  at org.apache.spark.sql.Dataset.withTypedCallback(Dataset.scala:2795)\n  at org.apache.spark.sql.Dataset.head(Dataset.scala:2112)\n  at org.apache.spark.sql.Dataset.take(Dataset.scala:2327)\n  at org.apache.spark.sql.Dataset.showString(Dataset.scala:248)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:636)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:595)\n  at org.apache.spark.sql.Dataset.show(Dataset.scala:604)\n  ... 50 elided\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579291901032_-152601008","id":"20200117-201141_50219659","dateCreated":"2020-01-17T20:11:41+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8634","text":".withColumn(\"Locations_split\", split($\"Locations\", \";\"))\n.withColumn(\"locations_unique\",explode($\"Locations_split\"))\n.drop($\"Themes\")\n.drop($\"Themes_split\")\n.drop($\"Locations\")\n.drop($\"Locations_split\")","dateUpdated":"2020-01-17T20:11:54+0000"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579273240130_-933975265","id":"20200117-150040_1238532940","dateCreated":"2020-01-17T15:00:40+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6733","text":"val question3Df = gkgDF_selected.select(\"SourceCommonName\",\"DocumentIdentifier\",\"V2Persons\",\"V2Themes\",\"V2Locations\",\"V2Tone\")\n.withColumn(\"Persons_split\", split($\"Persons\", \";\"))\n.withColumn(\"persons_unique\", explode($\"Persons_split\"))\n.withColumn(\"Themes_split\", split($\"Themes\", \";\"))\n.withColumn(\"themes_unique\",explode($\"Themes_split\"))\n.withColumn(\"Locations_split\", split($\"Locations\", \";\"))\n.withColumn(\"locations_unique\",explode($\"Locations_split\"))\n.drop($\"Persons\")\n.drop($\"Persons_split\")\n.drop($\"Themes\")\n.drop($\"Themes_split\")\n.drop($\"Locations\")\n.drop($\"Locations_split\")\n.show()","dateUpdated":"2020-01-17T19:24:46+0000","dateFinished":"2020-01-17T19:24:46+0000","dateStarted":"2020-01-17T19:24:46+0000","results":{"code":"ERROR","msg":[{"type":"TEXT","data":"org.apache.spark.sql.AnalysisException: cannot resolve '`Persons`' given input columns: [SourceCommonName, V2Tone, V2Persons, DocumentIdentifier, V2Locations, V2Themes];;\n'Project [SourceCommonName#3130, DocumentIdentifier#3137, V2Persons#3229, V2Themes#3175, V2Locations#3200, V2Tone#3280, split('Persons, ;) AS Persons_split#18231]\n+- Project [SourceCommonName#3130, DocumentIdentifier#3137, V2Persons#3229, V2Themes#3175, V2Locations#3200, V2Tone#3280]\n   +- Project [GKGRECORDID#3115, DATE#3119, SourceCommonName#3130, DocumentIdentifier#3137, V2Themes#3175, V2Locations#3200, V2Persons#3229, Organizations#3245, V2Tone#3280, TranslationInfo#3515]\n      +- Project [GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, Dates#3299, GCAM#3319, SharingImage#3340, RelatedImages#3362, SocialImageEmbeds#3385, SocialVideoEmbeds#3409, Quotations#3434, AllNames#3460, ... 3 more fields]\n         +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, Dates#3299, GCAM#3319, SharingImage#3340, RelatedImages#3362, SocialImageEmbeds#3385, SocialVideoEmbeds#3409, Quotations#3434, ... 4 more fields]\n            +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, Dates#3299, GCAM#3319, SharingImage#3340, RelatedImages#3362, SocialImageEmbeds#3385, SocialVideoEmbeds#3409, Quotations#3434, ... 3 more fields]\n               +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, Dates#3299, GCAM#3319, SharingImage#3340, RelatedImages#3362, SocialImageEmbeds#3385, SocialVideoEmbeds#3409, Quotations#3434, ... 2 more fields]\n                  +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, Dates#3299, GCAM#3319, SharingImage#3340, RelatedImages#3362, SocialImageEmbeds#3385, SocialVideoEmbeds#3409, Quotations#3434, split(value#3111, \\t)[23] AS AllNames#3460]\n                     +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, Dates#3299, GCAM#3319, SharingImage#3340, RelatedImages#3362, SocialImageEmbeds#3385, SocialVideoEmbeds#3409, split(value#3111, \\t)[22] AS Quotations#3434]\n                        +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, Dates#3299, GCAM#3319, SharingImage#3340, RelatedImages#3362, SocialImageEmbeds#3385, split(value#3111, \\t)[21] AS SocialVideoEmbeds#3409]\n                           +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, Dates#3299, GCAM#3319, SharingImage#3340, RelatedImages#3362, split(value#3111, \\t)[20] AS SocialImageEmbeds#3385]\n                              +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, Dates#3299, GCAM#3319, SharingImage#3340, split(value#3111, \\t)[19] AS RelatedImages#3362]\n                                 +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, Dates#3299, GCAM#3319, split(value#3111, \\t)[18] AS SharingImage#3340]\n                                    +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, Dates#3299, split(value#3111, \\t)[17] AS GCAM#3319]\n                                       +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, V2Tone#3280, split(value#3111, \\t)[16] AS Dates#3299]\n                                          +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, V2Organizations#3262, split(value#3111, \\t)[15] AS V2Tone#3280]\n                                             +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, Organizations#3245, split(value#3111, \\t)[14] AS V2Organizations#3262]\n                                                +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, V2Persons#3229, split(value#3111, \\t)[13] AS Organizations#3245]\n                                                   +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, Persons#3214, split(value#3111, \\t)[12] AS V2Persons#3229]\n                                                      +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, V2Locations#3200, split(value#3111, \\t)[11] AS Persons#3214]\n                                                         +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, Locations#3187, split(value#3111, \\t)[10] AS V2Locations#3200]\n                                                            +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, V2Themes#3175, split(value#3111, \\t)[9] AS Locations#3187]\n                                                               +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, Themes#3164, split(value#3111, \\t)[8] AS V2Themes#3175]\n                                                                  +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, V2Counts#3154, split(value#3111, \\t)[7] AS Themes#3164]\n                                                                     +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, Counts#3145, split(value#3111, \\t)[6] AS V2Counts#3154]\n                                                                        +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, DocumentIdentifier#3137, split(value#3111, \\t)[5] AS Counts#3145]\n                                                                           +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, SourceCommonName#3130, split(value#3111, \\t)[4] AS DocumentIdentifier#3137]\n                                                                              +- Project [value#3111, GKGRECORDID#3115, DATE#3119, SourceCollectionIdentifier#3124, split(value#3111, \\t)[3] AS SourceCommonName#3130]\n                                                                                 +- Project [value#3111, GKGRECORDID#3115, DATE#3119, split(value#3111, \\t)[2] AS SourceCollectionIdentifier#3124]\n                                                                                    +- Project [value#3111, GKGRECORDID#3115, split(value#3111, \\t)[1] AS DATE#3119]\n                                                                                       +- Project [value#3111, split(value#3111, \\t)[0] AS GKGRECORDID#3115]\n                                                                                          +- SerializeFromObject [staticinvoke(class org.apache.spark.unsafe.types.UTF8String, StringType, fromString, input[0, java.lang.String, true], true) AS value#3111]\n                                                                                             +- ExternalRDD [obj#3110]\n\n  at org.apache.spark.sql.catalyst.analysis.package$AnalysisErrorAt.failAnalysis(package.scala:42)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$2.applyOrElse(CheckAnalysis.scala:77)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1$$anonfun$apply$2.applyOrElse(CheckAnalysis.scala:74)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:310)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$transformUp$1.apply(TreeNode.scala:310)\n  at org.apache.spark.sql.catalyst.trees.CurrentOrigin$.withOrigin(TreeNode.scala:70)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:309)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$5.apply(TreeNode.scala:331)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transformChildren(TreeNode.scala:329)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:307)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$4.apply(TreeNode.scala:307)\n  at org.apache.spark.sql.catalyst.trees.TreeNode$$anonfun$5.apply(TreeNode.scala:331)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transformChildren(TreeNode.scala:329)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.transformUp(TreeNode.scala:307)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionUp$1(QueryPlan.scala:282)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$2(QueryPlan.scala:292)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$2$1.apply(QueryPlan.scala:296)\n  at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n  at scala.collection.TraversableLike$$anonfun$map$1.apply(TraversableLike.scala:234)\n  at scala.collection.mutable.ResizableArray$class.foreach(ResizableArray.scala:59)\n  at scala.collection.mutable.ArrayBuffer.foreach(ArrayBuffer.scala:48)\n  at scala.collection.TraversableLike$class.map(TraversableLike.scala:234)\n  at scala.collection.AbstractTraversable.map(Traversable.scala:104)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.org$apache$spark$sql$catalyst$plans$QueryPlan$$recursiveTransform$2(QueryPlan.scala:296)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan$$anonfun$7.apply(QueryPlan.scala:301)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.mapProductIterator(TreeNode.scala:188)\n  at org.apache.spark.sql.catalyst.plans.QueryPlan.transformExpressionsUp(QueryPlan.scala:301)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:74)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$$anonfun$checkAnalysis$1.apply(CheckAnalysis.scala:67)\n  at org.apache.spark.sql.catalyst.trees.TreeNode.foreachUp(TreeNode.scala:128)\n  at org.apache.spark.sql.catalyst.analysis.CheckAnalysis$class.checkAnalysis(CheckAnalysis.scala:67)\n  at org.apache.spark.sql.catalyst.analysis.Analyzer.checkAnalysis(Analyzer.scala:57)\n  at org.apache.spark.sql.execution.QueryExecution.assertAnalyzed(QueryExecution.scala:48)\n  at org.apache.spark.sql.Dataset$.ofRows(Dataset.scala:63)\n  at org.apache.spark.sql.Dataset.org$apache$spark$sql$Dataset$$withPlan(Dataset.scala:2822)\n  at org.apache.spark.sql.Dataset.select(Dataset.scala:1121)\n  at org.apache.spark.sql.Dataset.withColumn(Dataset.scala:1866)\n  ... 51 elided\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579284286800_-2054583084","id":"20200117-180446_75713206","dateCreated":"2020-01-17T18:04:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7683","text":"gkgDF_selected.show()","dateUpdated":"2020-01-17T18:05:28+0000","dateFinished":"2020-01-17T18:05:29+0000","dateStarted":"2020-01-17T18:05:28+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------------+--------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+---------------+\n|      GKGRECORDID|          DATE|    SourceCommonName|  DocumentIdentifier|              Themes|           Locations|             Persons|       Organizations|              V2Tone|TranslationInfo|\n+-----------------+--------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+---------------+\n| 20181201111500-0|20181201111500|     animalforum.com|http://www.animal...|                    |                    |                    |welcome to animal...|5.26315789473684,...|               |\n| 20181201111500-1|20181201111500|  theiranproject.com|https://theiranpr...|TAX_FNCACT;TAX_FN...|1#United States#U...|         reza najafi|organization for ...|-5.76923076923077...|               |\n| 20181201111500-2|20181201111500|      comunicati.net|http://www.comuni...|                    |1#China#CH#CH#35#...|                    |thinkrace technol...|3.0690537084399,4...|               |\n| 20181201111500-3|20181201111500| savannahtribune.com|http://www.savann...|TAX_FNCACT;TAX_FN...|                    |ormonde lewis jr;...|savannah classica...|2.56410256410256,...|               |\n| 20181201111500-4|20181201111500|         kickoff.com|http://www.kickof...|                    |4#Durban, Kwazulu...|dumisani zuma;zol...|                    |-1.64319248826291...|               |\n| 20181201111500-5|20181201111500| bordertelegraph.com|https://www.borde...|TAX_FNCACT;TAX_FN...|1#United Kingdom#...|       emma mcdonald|british florist a...|6.77966101694915,...|               |\n| 20181201111500-6|20181201111500|        artforum.com|https://www.artfo...|TAX_FNCACT;TAX_FN...|2#New York, Unite...|joni mitchell;sim...|twitter;facebook;...|-1.72413793103448...|               |\n| 20181201111500-7|20181201111500|mykisscountry937.com|http://mykisscoun...|LEADER;TAX_FNCACT...|                    |                    |grade at stockwel...|6.75675675675676,...|               |\n| 20181201111500-8|20181201111500|       panaynews.net|https://www.panay...|AGRICULTURE;NATUR...|4#Iloilo, Iloilo ...|imee marcos;remi ...|                    |-1.73160173160173...|               |\n| 20181201111500-9|20181201111500|       360cities.net|https://www.360ci...|TAX_FNCACT;TAX_FN...|1#United States#U...|         steve smith|                    |1.19760479041916,...|               |\n|20181201111500-10|20181201111500|      comunicati.net|http://www.comuni...|                    |1#China#CH#CH#35#...|                    |baowu group;posco...|0.260416666666667...|               |\n|20181201111500-11|20181201111500|        artforum.com|https://www.artfo...|EXTREMISM;RELIGIO...|1#United States#U...|matthew porterfie...|twitter;facebook;...|-0.3584229390681,...|               |\n|20181201111500-12|20181201111500|        artforum.com|https://www.artfo...|ENV_OIL;TAX_FNCAC...|1#Canada#CA#CA#60...|allie avital;kour...|red bull music ac...|-2.42857142857143...|               |\n|20181201111500-13|20181201111500|     altbitstorm.com|https://altbitsto...|                    |2#Delaware, Unite...|        estee lauder|unilever;clarins ...|2.10280373831776,...|               |\n|20181201111500-14|20181201111500|murfreesboropost.com|https://www.murfr...|       ENV_OIL;KILL;|                    |                    |national fire pro...|-1.8348623853211,...|               |\n|20181201111500-15|20181201111500|icelandmonitor.mb...|https://icelandmo...|SOVEREIGNTY;WB_84...|4#Reykjavik, (Ic1...|                    |        union treaty|6.49350649350649,...|               |\n|20181201111500-16|20181201111500|        thestate.com|https://www.thest...|LEADER;TAX_FNCACT...|1#Japan#JA#JA#36#...|caspar weinberger...|national assembly...|-5.96562184024267...|               |\n|20181201111500-17|20181201111500|          itclat.com|http://itclat.com...|                    |                    |                    |               intel|-0.69868995633187...|               |\n|20181201111500-18|20181201111500|        vologlam.com|https://www.volog...|GEN_HOLIDAY;TAX_F...|                    |                    |                    |5.93220338983051,...|               |\n|20181201111500-19|20181201111500|        benzinga.com|https://www.benzi...|TAX_FNCACT;TAX_FN...|                    |                    |                    |0,0.6896551724137...|               |\n+-----------------+--------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+--------------------+---------------+\nonly showing top 20 rows\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579282745266_-524214471","id":"20200117-173905_1027767770","dateCreated":"2020-01-17T17:39:05+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7360"},{"text":"%md \n### 4) dresser la cartographie des relations entre les pays d’après le ton des articles : pour chaque paire (pays1, pays2), calculer le nombre d’article, le ton moyen (aggrégations sur Année/Mois/Jour, filtrage par pays ou carré de coordonnées)","dateUpdated":"2020-01-17T07:54:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true},"colWidth":12,"editorMode":"ace/mode/markdown","editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>4) dresser la cartographie des relations entre les pays d’après le ton des articles : pour chaque paire (pays1, pays2), calculer le nombre d’article, le ton moyen (aggrégations sur Année/Mois/Jour, filtrage par pays ou carré de coordonnées)</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247674022_1286959837","id":"20200116-205503_1066054129","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1747"},{"dateUpdated":"2020-01-17T07:54:34+0000","config":{"colWidth":12,"editorMode":"ace/mode/scala","results":{},"enabled":true,"editorSetting":{"language":"scala"}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579247674023_1286575088","id":"20200116-205504_640282449","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1748"},{"text":"%md A vous de jouer ! Utilisez la documentation GDELT(https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/) et commencez a explorer les donnees via les API Spark.","dateUpdated":"2020-01-17T07:54:34+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionKey":"TAB","completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>A vous de jouer ! Utilisez la documentation GDELT(<a href=\"https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/\">https://blog.gdeltproject.org/gdelt-2-0-our-global-world-in-realtime/</a>) et commencez a explorer les donnees via les API Spark.</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1579247674023_1286575088","id":"20171218-084519_765381887","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1749"},{"text":"%md\n","dateUpdated":"2020-01-17T07:54:34+0000","config":{"colWidth":12,"editorMode":"ace/mode/markdown","results":{},"enabled":true,"editorSetting":{"language":"markdown","editOnDblClick":true}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1579247674023_1286575088","id":"20200116-205502_1328365913","dateCreated":"2020-01-17T07:54:34+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:1750"}],"name":"gdeltExploration (Local with Docker MasterfileList + TRANSLATION)","id":"2EYV4RHVK","angularObjects":{"2EYPY223T:shared_process":[],"2EYYTFNAD:shared_process":[],"2EX7VKUP1:shared_process":[],"2F1F6SEVR:shared_process":[],"2EZARAFF4:shared_process":[],"2F1MT56CW:shared_process":[],"2F157RCMK:shared_process":[],"2EX1TKZSR:shared_process":[],"2EZ6EMJVP:shared_process":[],"2F15KKJS9:shared_process":[],"2F1BC7AU9:shared_process":[],"2EZ3ZXSJT:shared_process":[],"2EWWVH375:shared_process":[],"2EXZQ8PDR:shared_process":[],"2EXA1J2E1:shared_process":[],"2F1C69A9F:shared_process":[],"2F15R35E4:shared_process":[],"2EXP3UZPC:shared_process":[],"2EY37ZU97:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}